(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const p of document.querySelectorAll('link[rel="modulepreload"]'))d(p);new MutationObserver(p=>{for(const m of p)if(m.type==="childList")for(const S of m.addedNodes)S.tagName==="LINK"&&S.rel==="modulepreload"&&d(S)}).observe(document,{childList:!0,subtree:!0});function h(p){const m={};return p.integrity&&(m.integrity=p.integrity),p.referrerPolicy&&(m.referrerPolicy=p.referrerPolicy),p.crossOrigin==="use-credentials"?m.credentials="include":p.crossOrigin==="anonymous"?m.credentials="omit":m.credentials="same-origin",m}function d(p){if(p.ep)return;p.ep=!0;const m=h(p);fetch(p.href,m)}})();var Se=1e-6,Gt=typeof Float32Array<"u"?Float32Array:Array;function Ot(){var u=new Gt(16);return Gt!=Float32Array&&(u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[11]=0,u[12]=0,u[13]=0,u[14]=0),u[0]=1,u[5]=1,u[10]=1,u[15]=1,u}function Cr(u){return u[0]=1,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=1,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[10]=1,u[11]=0,u[12]=0,u[13]=0,u[14]=0,u[15]=1,u}function Tr(u,a,h){var d=a[0],p=a[1],m=a[2],S=a[3],y=a[4],E=a[5],U=a[6],P=a[7],F=a[8],R=a[9],L=a[10],Y=a[11],$=a[12],X=a[13],Q=a[14],rt=a[15],I=h[0],T=h[1],k=h[2],H=h[3];return u[0]=I*d+T*y+k*F+H*$,u[1]=I*p+T*E+k*R+H*X,u[2]=I*m+T*U+k*L+H*Q,u[3]=I*S+T*P+k*Y+H*rt,I=h[4],T=h[5],k=h[6],H=h[7],u[4]=I*d+T*y+k*F+H*$,u[5]=I*p+T*E+k*R+H*X,u[6]=I*m+T*U+k*L+H*Q,u[7]=I*S+T*P+k*Y+H*rt,I=h[8],T=h[9],k=h[10],H=h[11],u[8]=I*d+T*y+k*F+H*$,u[9]=I*p+T*E+k*R+H*X,u[10]=I*m+T*U+k*L+H*Q,u[11]=I*S+T*P+k*Y+H*rt,I=h[12],T=h[13],k=h[14],H=h[15],u[12]=I*d+T*y+k*F+H*$,u[13]=I*p+T*E+k*R+H*X,u[14]=I*m+T*U+k*L+H*Q,u[15]=I*S+T*P+k*Y+H*rt,u}function Mr(u,a,h){var d=h[0],p=h[1],m=h[2],S,y,E,U,P,F,R,L,Y,$,X,Q;return a===u?(u[12]=a[0]*d+a[4]*p+a[8]*m+a[12],u[13]=a[1]*d+a[5]*p+a[9]*m+a[13],u[14]=a[2]*d+a[6]*p+a[10]*m+a[14],u[15]=a[3]*d+a[7]*p+a[11]*m+a[15]):(S=a[0],y=a[1],E=a[2],U=a[3],P=a[4],F=a[5],R=a[6],L=a[7],Y=a[8],$=a[9],X=a[10],Q=a[11],u[0]=S,u[1]=y,u[2]=E,u[3]=U,u[4]=P,u[5]=F,u[6]=R,u[7]=L,u[8]=Y,u[9]=$,u[10]=X,u[11]=Q,u[12]=S*d+P*p+Y*m+a[12],u[13]=y*d+F*p+$*m+a[13],u[14]=E*d+R*p+X*m+a[14],u[15]=U*d+L*p+Q*m+a[15]),u}function bn(u,a,h){var d=Math.sin(h),p=Math.cos(h),m=a[4],S=a[5],y=a[6],E=a[7],U=a[8],P=a[9],F=a[10],R=a[11];return a!==u&&(u[0]=a[0],u[1]=a[1],u[2]=a[2],u[3]=a[3],u[12]=a[12],u[13]=a[13],u[14]=a[14],u[15]=a[15]),u[4]=m*p+U*d,u[5]=S*p+P*d,u[6]=y*p+F*d,u[7]=E*p+R*d,u[8]=U*p-m*d,u[9]=P*p-S*d,u[10]=F*p-y*d,u[11]=R*p-E*d,u}function jn(u,a,h){var d=Math.sin(h),p=Math.cos(h),m=a[0],S=a[1],y=a[2],E=a[3],U=a[8],P=a[9],F=a[10],R=a[11];return a!==u&&(u[4]=a[4],u[5]=a[5],u[6]=a[6],u[7]=a[7],u[12]=a[12],u[13]=a[13],u[14]=a[14],u[15]=a[15]),u[0]=m*p-U*d,u[1]=S*p-P*d,u[2]=y*p-F*d,u[3]=E*p-R*d,u[8]=m*d+U*p,u[9]=S*d+P*p,u[10]=y*d+F*p,u[11]=E*d+R*p,u}function Pn(u,a,h,d,p){var m=1/Math.tan(a/2);if(u[0]=m/h,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=m,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[11]=-1,u[12]=0,u[13]=0,u[15]=0,p!=null&&p!==1/0){var S=1/(d-p);u[10]=(p+d)*S,u[14]=2*p*d*S}else u[10]=-1,u[14]=-2*d;return u}var Tn=Pn;function Mn(u,a,h,d){var p,m,S,y,E,U,P,F,R,L,Y=a[0],$=a[1],X=a[2],Q=d[0],rt=d[1],I=d[2],T=h[0],k=h[1],H=h[2];return Math.abs(Y-T)<Se&&Math.abs($-k)<Se&&Math.abs(X-H)<Se?Cr(u):(P=Y-T,F=$-k,R=X-H,L=1/Math.sqrt(P*P+F*F+R*R),P*=L,F*=L,R*=L,p=rt*R-I*F,m=I*P-Q*R,S=Q*F-rt*P,L=Math.sqrt(p*p+m*m+S*S),L?(L=1/L,p*=L,m*=L,S*=L):(p=0,m=0,S=0),y=F*S-R*m,E=R*p-P*S,U=P*m-F*p,L=Math.sqrt(y*y+E*E+U*U),L?(L=1/L,y*=L,E*=L,U*=L):(y=0,E=0,U=0),u[0]=p,u[1]=y,u[2]=P,u[3]=0,u[4]=m,u[5]=E,u[6]=F,u[7]=0,u[8]=S,u[9]=U,u[10]=R,u[11]=0,u[12]=-(p*Y+m*$+S*X),u[13]=-(y*Y+E*$+U*X),u[14]=-(P*Y+F*$+R*X),u[15]=1,u)}function Ur(){var u=new Gt(3);return Gt!=Float32Array&&(u[0]=0,u[1]=0,u[2]=0),u}function Ae(u,a,h){var d=new Gt(3);return d[0]=u,d[1]=a,d[2]=h,d}function On(u,a,h){var d=a[0],p=a[1],m=a[2],S=h[3]*d+h[7]*p+h[11]*m+h[15];return S=S||1,u[0]=(h[0]*d+h[4]*p+h[8]*m+h[12])/S,u[1]=(h[1]*d+h[5]*p+h[9]*m+h[13])/S,u[2]=(h[2]*d+h[6]*p+h[10]*m+h[14])/S,u}(function(){var u=Ur();return function(a,h,d,p,m,S){var y,E;for(h||(h=3),d||(d=0),p?E=Math.min(p*h+d,a.length):E=a.length,y=d;y<E;y+=h)u[0]=a[y],u[1]=a[y+1],u[2]=a[y+2],m(u,u,S),a[y]=u[0],a[y+1]=u[1],a[y+2]=u[2];return a}})();const Bn=`struct CameraUniforms {
  vpMatrix: mat4x4<f32>,
};

struct ShapeUniforms {
  modelMatrix: mat4x4<f32>,
  threat: f32,
  targeted: f32,
  time: f32,
  padding: f32,
};

@binding(0) @group(0) var<uniform> camera: CameraUniforms;
@binding(1) @group(0) var<uniform> shape: ShapeUniforms;

struct VertexInput {
  @location(0) position: vec3<f32>,
  @location(1) normal: vec3<f32>,
};

struct VertexOutput {
  @builtin(position) position: vec4<f32>,
  @location(0) normal: vec3<f32>,
  @location(1) threat: f32,
  @location(2) targeted: f32,
};

@vertex
fn main(input: VertexInput) -> VertexOutput {
  var output: VertexOutput;
  
  let worldPos = shape.modelMatrix * vec4<f32>(input.position, 1.0);
  output.position = camera.vpMatrix * worldPos;
  
  let normalMatrix = mat3x3<f32>(
    shape.modelMatrix[0].xyz,
    shape.modelMatrix[1].xyz,
    shape.modelMatrix[2].xyz
  );
  output.normal = normalize(normalMatrix * input.normal);
  
  output.threat = shape.threat;
  output.targeted = shape.targeted;
  
  return output;
}`,Cn=`struct FragmentInput {
  @location(0) normal: vec3<f32>,
  @location(1) threat: f32,
  @location(2) targeted: f32,
};

@fragment
fn main(input: FragmentInput) -> @location(0) vec4<f32> {
  let N = normalize(input.normal);
  let lightDir = normalize(vec3<f32>(0.5, 1.0, 0.8));
  let diffuse = max(dot(N, lightDir), 0.0) * 0.7 + 0.3;
  
  var color: vec3<f32>;
  if (input.threat < 0.5) {
    color = mix(vec3<f32>(0.0, 1.0, 0.0), vec3<f32>(1.0, 1.0, 0.0), input.threat * 2.0);
  } else {
    color = mix(vec3<f32>(1.0, 1.0, 0.0), vec3<f32>(1.0, 0.0, 0.0), (input.threat - 0.5) * 2.0);
  }
  
  if (input.threat > 0.8) {
    let flash = sin(input.threat * 50.0) * 0.5 + 0.5;
    color += vec3<f32>(flash * 0.5);
  }
  
  if (input.targeted > 0.5) {
    color += vec3<f32>(0.3, 0.3, 0.3);
  }
  
  let finalColor = color * diffuse;
  
  return vec4<f32>(finalColor, 1.0);
}`,Un=`struct CameraUniforms {
  vpMatrix: mat4x4<f32>,
};

struct ShapeUniforms {
  modelMatrix: mat4x4<f32>,
  color: vec3<f32>,
  padding: f32,
};

@binding(0) @group(0) var<uniform> camera: CameraUniforms;
@binding(1) @group(0) var<uniform> shape: ShapeUniforms;

struct VertexInput {
  @location(0) position: vec3<f32>,
  @location(1) color: vec3<f32>,
  @location(2) alpha: f32,
};

struct VertexOutput {
  @builtin(position) position: vec4<f32>,
  @location(0) color: vec3<f32>,
  @location(1) alpha: f32,
};

@vertex
fn main(input: VertexInput) -> VertexOutput {
  var output: VertexOutput;
  
  let worldPos = shape.modelMatrix * vec4<f32>(input.position, 1.0);
  output.position = camera.vpMatrix * worldPos;
  output.color = input.color;
  output.alpha = input.alpha;
  
  return output;
}`,Fn=`struct FragmentInput {
  @location(0) color: vec3<f32>,
  @location(1) alpha: f32,
};

@fragment
fn main(input: FragmentInput) -> @location(0) vec4<f32> {
  return vec4<f32>(input.color, input.alpha);
}`;class Ln{constructor(a){this.canvas=a,this.device=null,this.context=null,this.format=null,this.shapePipeline=null,this.particlePipeline=null,this.depthTexture=null,this.cameraUniformBuffer=null,this.shapeUniformBuffer=null,this.bindGroup=null,this.viewMatrix=Ot(),this.projectionMatrix=Ot()}async init(){if(!navigator.gpu)throw new Error("WebGPU not supported");this.canvas.width=window.innerWidth,this.canvas.height=window.innerHeight;const a=await navigator.gpu.requestAdapter();this.device=await a.requestDevice(),this.context=this.canvas.getContext("webgpu"),this.format=navigator.gpu.getPreferredCanvasFormat(),this.context.configure({device:this.device,format:this.format,alphaMode:"premultiplied"}),this.createDepthTexture(),this.createUniformBuffers(),this.createPipelines(),Cr(this.viewMatrix),Mn(this.viewMatrix,Ae(0,0,0),Ae(0,0,-1),Ae(0,1,0)),window.addEventListener("resize",()=>this.handleResize())}createDepthTexture(){this.depthTexture=this.device.createTexture({size:[this.canvas.width,this.canvas.height],format:"depth24plus",usage:GPUTextureUsage.RENDER_ATTACHMENT})}createUniformBuffers(){this.cameraUniformBuffer=this.device.createBuffer({size:128,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST}),this.shapeUniformBuffer=this.device.createBuffer({size:64,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST})}createPipelines(){const a=this.device.createBindGroupLayout({entries:[{binding:0,visibility:GPUShaderStage.VERTEX|GPUShaderStage.FRAGMENT,buffer:{type:"uniform"}},{binding:1,visibility:GPUShaderStage.VERTEX|GPUShaderStage.FRAGMENT,buffer:{type:"uniform"}}]});this.bindGroup=this.device.createBindGroup({layout:a,entries:[{binding:0,resource:{buffer:this.cameraUniformBuffer}},{binding:1,resource:{buffer:this.shapeUniformBuffer}}]}),this.shapePipeline=this.device.createRenderPipeline({layout:this.device.createPipelineLayout({bindGroupLayouts:[a]}),vertex:{module:this.device.createShaderModule({code:Bn}),entryPoint:"main",buffers:[{arrayStride:24,attributes:[{shaderLocation:0,offset:0,format:"float32x3"},{shaderLocation:1,offset:12,format:"float32x3"}]}]},fragment:{module:this.device.createShaderModule({code:Cn}),entryPoint:"main",targets:[{format:this.format}]},primitive:{topology:"triangle-list",cullMode:"back"},depthStencil:{format:"depth24plus",depthWriteEnabled:!0,depthCompare:"less"}}),this.particlePipeline=this.device.createRenderPipeline({layout:this.device.createPipelineLayout({bindGroupLayouts:[a]}),vertex:{module:this.device.createShaderModule({code:Un}),entryPoint:"main",buffers:[{arrayStride:28,attributes:[{shaderLocation:0,offset:0,format:"float32x3"},{shaderLocation:1,offset:12,format:"float32x3"},{shaderLocation:2,offset:24,format:"float32"}]}]},fragment:{module:this.device.createShaderModule({code:Fn}),entryPoint:"main",targets:[{format:this.format,blend:{color:{srcFactor:"src-alpha",dstFactor:"one",operation:"add"},alpha:{srcFactor:"one",dstFactor:"one",operation:"add"}}}]},primitive:{topology:"triangle-list"},depthStencil:{format:"depth24plus",depthWriteEnabled:!1,depthCompare:"less"}})}render({shapes:a,particles:h,targetedShape:d,deltaTime:p}){const m=this.canvas.width/this.canvas.height;Tn(this.projectionMatrix,60*Math.PI/180,m,.1,100);const S=Ot();Tr(S,this.projectionMatrix,this.viewMatrix);const y=new Float32Array(32);y.set(S,0),this.device.queue.writeBuffer(this.cameraUniformBuffer,0,y);const E=this.device.createCommandEncoder(),U=this.context.getCurrentTexture().createView(),P=E.beginRenderPass({colorAttachments:[{view:U,loadOp:"clear",storeOp:"store",clearValue:{r:0,g:0,b:.05,a:1}}],depthStencilAttachment:{view:this.depthTexture.createView(),depthClearValue:1,depthLoadOp:"clear",depthStoreOp:"store"}});P.setPipeline(this.shapePipeline),P.setBindGroup(0,this.bindGroup),a.forEach(F=>{this.renderShape(P,F,F===d)}),h&&h.length>0&&(P.setPipeline(this.particlePipeline),h.forEach(F=>{this.renderParticle(P,F)})),P.end(),this.device.queue.submit([E.finish()])}renderShape(a,h,d){const p=Math.abs(h.position[2]),m=Math.max(0,Math.min(1,(10-p)/8)),S=performance.now()/1e3,y=new Float32Array(16),E=Ot();Mr(E,E,h.position),jn(E,E,h.rotation[1]),bn(E,E,h.rotation[0]),y.set(E,0),y[12]=m,y[13]=d?1:0,y[14]=S,y[15]=0,this.device.queue.writeBuffer(this.shapeUniformBuffer,0,y),a.setVertexBuffer(0,h.vertexBuffer),a.setIndexBuffer(h.indexBuffer,"uint16"),a.drawIndexed(h.indexCount)}renderParticle(a,h){const d=new Float32Array(16),p=Ot();Mr(p,p,h.position),d.set(p,0),d.set(h.color,12),this.device.queue.writeBuffer(this.shapeUniformBuffer,0,d),a.setVertexBuffer(0,h.vertexBuffer),a.draw(6)}projectToScreen(a){const h=Ot();Tr(h,this.projectionMatrix,this.viewMatrix);const d=Ur();if(On(d,a,h),d[2]>1)return null;const p=d[0]/(d[2]+.01),m=d[1]/(d[2]+.01),S=(p+1)*.5*this.canvas.width,y=(1-m)*.5*this.canvas.height;return{x:S,y}}handleResize(){this.canvas.width=window.innerWidth,this.canvas.height=window.innerHeight,this.depthTexture.destroy(),this.createDepthTexture(),this.context.configure({device:this.device,format:this.format,alphaMode:"premultiplied"})}destroy(){this.depthTexture&&this.depthTexture.destroy(),this.cameraUniformBuffer&&this.cameraUniformBuffer.destroy(),this.shapeUniformBuffer&&this.shapeUniformBuffer.destroy()}}class Rn{constructor(){this.score=0,this.wave=1,this.isGameOver=!1,this.shapesDestroyed=0}reset(){this.score=0,this.wave=1,this.isGameOver=!1,this.shapesDestroyed=0}addScore(a){this.score+=a,this.shapesDestroyed++,this.shapesDestroyed%10===0&&this.wave++}getSpawnRate(){return Math.max(.5,2-this.wave*.1)}getShapeSpeed(){return 1+this.wave*.1}}class _n{constructor(a){this.renderer=a,this.device=a.device,this.shapes=[],this.spawnTimer=0,this.shapeTypes=["cube","sphere","torus","pyramid"]}reset(){this.shapes.forEach(a=>{a.vertexBuffer&&a.vertexBuffer.destroy(),a.indexBuffer&&a.indexBuffer.destroy()}),this.shapes=[],this.spawnTimer=0}update(a,h){this.spawnTimer+=a;const d=Math.max(.5,2-h*.1);this.spawnTimer>=d&&(this.spawnTimer=0,this.spawnRandomShape(h)),this.shapes.forEach(p=>{p.rotation[0]+=a*.5,p.rotation[1]+=a*.3})}spawnRandomShape(a){const h=this.shapeTypes[Math.floor(Math.random()*this.shapeTypes.length)],d=(Math.random()-.5)*6,p=(Math.random()-.5)*4,m=-15,S=1+a*.1,y={type:h,position:[d,p,m],rotation:[0,0,0],velocity:S,color:[1,1,1]};this.createShapeGeometry(y),this.shapes.push(y)}createShapeGeometry(a){let h,d;switch(a.type){case"cube":({vertices:h,indices:d}=this.createCube());break;case"sphere":({vertices:h,indices:d}=this.createSphere());break;case"torus":({vertices:h,indices:d}=this.createTorus());break;case"pyramid":({vertices:h,indices:d}=this.createPyramid());break}const p=new Float32Array(h),m=new Uint16Array(d);a.vertexBuffer=this.device.createBuffer({size:p.byteLength,usage:GPUBufferUsage.VERTEX|GPUBufferUsage.COPY_DST}),this.device.queue.writeBuffer(a.vertexBuffer,0,p),a.indexBuffer=this.device.createBuffer({size:m.byteLength,usage:GPUBufferUsage.INDEX|GPUBufferUsage.COPY_DST}),this.device.queue.writeBuffer(a.indexBuffer,0,m),a.indexCount=d.length}createCube(){return{vertices:[-.5,-.5,.5,0,0,1,.5,-.5,.5,0,0,1,.5,.5,.5,0,0,1,-.5,.5,.5,0,0,1,-.5,-.5,-.5,0,0,-1,.5,-.5,-.5,0,0,-1,.5,.5,-.5,0,0,-1,-.5,.5,-.5,0,0,-1],indices:[0,1,2,0,2,3,5,4,7,5,7,6,4,0,3,4,3,7,1,5,6,1,6,2,3,2,6,3,6,7,4,5,1,4,1,0]}}createSphere(){const a=[],h=[];for(let m=0;m<=12;m++){const S=m/12*Math.PI,y=Math.cos(S),E=Math.sin(S);for(let U=0;U<=16;U++){const P=U/16*Math.PI*2,F=E*Math.cos(P),R=E*Math.sin(P);a.push(F*.5,y*.5,R*.5);const L=Math.sqrt(F*F+y*y+R*R);a.push(F/L,y/L,R/L)}}for(let m=0;m<12;m++)for(let S=0;S<16;S++){const y=m*17+S,E=y+16+1;h.push(y,E,y+1),h.push(y+1,E,E+1)}return{vertices:a,indices:h}}createTorus(){const a=[],h=[];for(let y=0;y<=20;y++){const E=y/20*Math.PI*2,U=Math.cos(E),P=Math.sin(E);for(let F=0;F<=12;F++){const R=F/12*Math.PI*2,L=Math.cos(R),Y=Math.sin(R),$=(.4+.15*L)*U,X=.15*Y,Q=(.4+.15*L)*P;a.push($,X,Q);const rt=L*U,I=Y,T=L*P;a.push(rt,I,T)}}for(let y=0;y<20;y++)for(let E=0;E<12;E++){const U=y*13+E,P=U+12+1;h.push(U,P,U+1),h.push(U+1,P,P+1)}return{vertices:a,indices:h}}createPyramid(){return{vertices:[0,.5,0,0,1,0,-.5,-.5,.5,0,-1,0,.5,-.5,.5,0,-1,0,.5,-.5,-.5,0,-1,0,-.5,-.5,-.5,0,-1,0],indices:[0,1,2,0,2,3,0,3,4,0,4,1,1,3,2,1,4,3]}}removeShape(a){const h=this.shapes.indexOf(a);h>-1&&(a.vertexBuffer&&a.vertexBuffer.destroy(),a.indexBuffer&&a.indexBuffer.destroy(),this.shapes.splice(h,1))}getShapes(){return this.shapes}}var qt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Ee={},Or;function In(){return Or||(Or=1,(function(){var u;function a(t){var e=0;return function(){return e<t.length?{done:!1,value:t[e++]}:{done:!0}}}var h=typeof Object.defineProperties=="function"?Object.defineProperty:function(t,e,r){return t==Array.prototype||t==Object.prototype||(t[e]=r.value),t};function d(t){t=[typeof globalThis=="object"&&globalThis,t,typeof window=="object"&&window,typeof self=="object"&&self,typeof qt=="object"&&qt];for(var e=0;e<t.length;++e){var r=t[e];if(r&&r.Math==Math)return r}throw Error("Cannot find global object")}var p=d(this);function m(t,e){if(e)t:{var r=p;t=t.split(".");for(var n=0;n<t.length-1;n++){var i=t[n];if(!(i in r))break t;r=r[i]}t=t[t.length-1],n=r[t],e=e(n),e!=n&&e!=null&&h(r,t,{configurable:!0,writable:!0,value:e})}}m("Symbol",function(t){function e(s){if(this instanceof e)throw new TypeError("Symbol is not a constructor");return new r(n+(s||"")+"_"+i++,s)}function r(s,o){this.h=s,h(this,"description",{configurable:!0,writable:!0,value:o})}if(t)return t;r.prototype.toString=function(){return this.h};var n="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",i=0;return e}),m("Symbol.iterator",function(t){if(t)return t;t=Symbol("Symbol.iterator");for(var e="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),r=0;r<e.length;r++){var n=p[e[r]];typeof n=="function"&&typeof n.prototype[t]!="function"&&h(n.prototype,t,{configurable:!0,writable:!0,value:function(){return S(a(this))}})}return t});function S(t){return t={next:t},t[Symbol.iterator]=function(){return this},t}function y(t){var e=typeof Symbol<"u"&&Symbol.iterator&&t[Symbol.iterator];return e?e.call(t):{next:a(t)}}function E(t){if(!(t instanceof Array)){t=y(t);for(var e,r=[];!(e=t.next()).done;)r.push(e.value);t=r}return t}var U=typeof Object.assign=="function"?Object.assign:function(t,e){for(var r=1;r<arguments.length;r++){var n=arguments[r];if(n)for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t};m("Object.assign",function(t){return t||U});var P=typeof Object.create=="function"?Object.create:function(t){function e(){}return e.prototype=t,new e},F;if(typeof Object.setPrototypeOf=="function")F=Object.setPrototypeOf;else{var R;t:{var L={a:!0},Y={};try{Y.__proto__=L,R=Y.a;break t}catch{}R=!1}F=R?function(t,e){if(t.__proto__=e,t.__proto__!==e)throw new TypeError(t+" is not extensible");return t}:null}var $=F;function X(t,e){if(t.prototype=P(e.prototype),t.prototype.constructor=t,$)$(t,e);else for(var r in e)if(r!="prototype")if(Object.defineProperties){var n=Object.getOwnPropertyDescriptor(e,r);n&&Object.defineProperty(t,r,n)}else t[r]=e[r];t.ya=e.prototype}function Q(){this.m=!1,this.j=null,this.i=void 0,this.h=1,this.v=this.s=0,this.l=null}function rt(t){if(t.m)throw new TypeError("Generator is already running");t.m=!0}Q.prototype.u=function(t){this.i=t};function I(t,e){t.l={ma:e,na:!0},t.h=t.s||t.v}Q.prototype.return=function(t){this.l={return:t},this.h=this.v};function T(t,e,r){return t.h=r,{value:e}}function k(t){this.h=new Q,this.i=t}function H(t,e){rt(t.h);var r=t.h.j;return r?mt(t,"return"in r?r.return:function(n){return{value:n,done:!0}},e,t.h.return):(t.h.return(e),et(t))}function mt(t,e,r,n){try{var i=e.call(t.h.j,r);if(!(i instanceof Object))throw new TypeError("Iterator result "+i+" is not an object");if(!i.done)return t.h.m=!1,i;var s=i.value}catch(o){return t.h.j=null,I(t.h,o),et(t)}return t.h.j=null,n.call(t.h,s),et(t)}function et(t){for(;t.h.h;)try{var e=t.i(t.h);if(e)return t.h.m=!1,{value:e.value,done:!1}}catch(r){t.h.i=void 0,I(t.h,r)}if(t.h.m=!1,t.h.l){if(e=t.h.l,t.h.l=null,e.na)throw e.ma;return{value:e.return,done:!0}}return{value:void 0,done:!0}}function yt(t){this.next=function(e){return rt(t.h),t.h.j?e=mt(t,t.h.j.next,e,t.h.u):(t.h.u(e),e=et(t)),e},this.throw=function(e){return rt(t.h),t.h.j?e=mt(t,t.h.j.throw,e,t.h.u):(I(t.h,e),e=et(t)),e},this.return=function(e){return H(t,e)},this[Symbol.iterator]=function(){return this}}function f(t){function e(n){return t.next(n)}function r(n){return t.throw(n)}return new Promise(function(n,i){function s(o){o.done?n(o.value):Promise.resolve(o.value).then(e,r).then(s,i)}s(t.next())})}function v(t){return f(new yt(new k(t)))}m("Promise",function(t){function e(o){this.i=0,this.j=void 0,this.h=[],this.u=!1;var c=this.l();try{o(c.resolve,c.reject)}catch(l){c.reject(l)}}function r(){this.h=null}function n(o){return o instanceof e?o:new e(function(c){c(o)})}if(t)return t;r.prototype.i=function(o){if(this.h==null){this.h=[];var c=this;this.j(function(){c.m()})}this.h.push(o)};var i=p.setTimeout;r.prototype.j=function(o){i(o,0)},r.prototype.m=function(){for(;this.h&&this.h.length;){var o=this.h;this.h=[];for(var c=0;c<o.length;++c){var l=o[c];o[c]=null;try{l()}catch(g){this.l(g)}}}this.h=null},r.prototype.l=function(o){this.j(function(){throw o})},e.prototype.l=function(){function o(g){return function(x){l||(l=!0,g.call(c,x))}}var c=this,l=!1;return{resolve:o(this.I),reject:o(this.m)}},e.prototype.I=function(o){if(o===this)this.m(new TypeError("A Promise cannot resolve to itself"));else if(o instanceof e)this.L(o);else{t:switch(typeof o){case"object":var c=o!=null;break t;case"function":c=!0;break t;default:c=!1}c?this.F(o):this.s(o)}},e.prototype.F=function(o){var c=void 0;try{c=o.then}catch(l){this.m(l);return}typeof c=="function"?this.M(c,o):this.s(o)},e.prototype.m=function(o){this.v(2,o)},e.prototype.s=function(o){this.v(1,o)},e.prototype.v=function(o,c){if(this.i!=0)throw Error("Cannot settle("+o+", "+c+"): Promise already settled in state"+this.i);this.i=o,this.j=c,this.i===2&&this.K(),this.H()},e.prototype.K=function(){var o=this;i(function(){if(o.D()){var c=p.console;typeof c<"u"&&c.error(o.j)}},1)},e.prototype.D=function(){if(this.u)return!1;var o=p.CustomEvent,c=p.Event,l=p.dispatchEvent;return typeof l>"u"?!0:(typeof o=="function"?o=new o("unhandledrejection",{cancelable:!0}):typeof c=="function"?o=new c("unhandledrejection",{cancelable:!0}):(o=p.document.createEvent("CustomEvent"),o.initCustomEvent("unhandledrejection",!1,!0,o)),o.promise=this,o.reason=this.j,l(o))},e.prototype.H=function(){if(this.h!=null){for(var o=0;o<this.h.length;++o)s.i(this.h[o]);this.h=null}};var s=new r;return e.prototype.L=function(o){var c=this.l();o.T(c.resolve,c.reject)},e.prototype.M=function(o,c){var l=this.l();try{o.call(c,l.resolve,l.reject)}catch(g){l.reject(g)}},e.prototype.then=function(o,c){function l(b,A){return typeof b=="function"?function(B){try{g(b(B))}catch(_){x(_)}}:A}var g,x,O=new e(function(b,A){g=b,x=A});return this.T(l(o,g),l(c,x)),O},e.prototype.catch=function(o){return this.then(void 0,o)},e.prototype.T=function(o,c){function l(){switch(g.i){case 1:o(g.j);break;case 2:c(g.j);break;default:throw Error("Unexpected state: "+g.i)}}var g=this;this.h==null?s.i(l):this.h.push(l),this.u=!0},e.resolve=n,e.reject=function(o){return new e(function(c,l){l(o)})},e.race=function(o){return new e(function(c,l){for(var g=y(o),x=g.next();!x.done;x=g.next())n(x.value).T(c,l)})},e.all=function(o){var c=y(o),l=c.next();return l.done?n([]):new e(function(g,x){function O(B){return function(_){b[B]=_,A--,A==0&&g(b)}}var b=[],A=0;do b.push(void 0),A++,n(l.value).T(O(b.length-1),x),l=c.next();while(!l.done)})},e});function C(t,e){t instanceof String&&(t+="");var r=0,n=!1,i={next:function(){if(!n&&r<t.length){var s=r++;return{value:e(s,t[s]),done:!1}}return n=!0,{done:!0,value:void 0}}};return i[Symbol.iterator]=function(){return i},i}m("Array.prototype.keys",function(t){return t||function(){return C(this,function(e){return e})}}),m("Array.prototype.fill",function(t){return t||function(e,r,n){var i=this.length||0;for(0>r&&(r=Math.max(0,i+r)),(n==null||n>i)&&(n=i),n=Number(n),0>n&&(n=Math.max(0,i+n)),r=Number(r||0);r<n;r++)this[r]=e;return this}});function j(t){return t||Array.prototype.fill}m("Int8Array.prototype.fill",j),m("Uint8Array.prototype.fill",j),m("Uint8ClampedArray.prototype.fill",j),m("Int16Array.prototype.fill",j),m("Uint16Array.prototype.fill",j),m("Int32Array.prototype.fill",j),m("Uint32Array.prototype.fill",j),m("Float32Array.prototype.fill",j),m("Float64Array.prototype.fill",j),m("Object.is",function(t){return t||function(e,r){return e===r?e!==0||1/e===1/r:e!==e&&r!==r}}),m("Array.prototype.includes",function(t){return t||function(e,r){var n=this;n instanceof String&&(n=String(n));var i=n.length;for(r=r||0,0>r&&(r=Math.max(r+i,0));r<i;r++){var s=n[r];if(s===e||Object.is(s,e))return!0}return!1}}),m("String.prototype.includes",function(t){return t||function(e,r){if(this==null)throw new TypeError("The 'this' value for String.prototype.includes must not be null or undefined");if(e instanceof RegExp)throw new TypeError("First argument to String.prototype.includes must not be a regular expression");return this.indexOf(e,r||0)!==-1}});var N=this||self;function Z(t,e){t=t.split(".");var r=N;t[0]in r||typeof r.execScript>"u"||r.execScript("var "+t[0]);for(var n;t.length&&(n=t.shift());)t.length||e===void 0?r[n]&&r[n]!==Object.prototype[n]?r=r[n]:r=r[n]={}:r[n]=e}function w(t){var e;t:{if((e=N.navigator)&&(e=e.userAgent))break t;e=""}return e.indexOf(t)!=-1}var M=Array.prototype.map?function(t,e){return Array.prototype.map.call(t,e,void 0)}:function(t,e){for(var r=t.length,n=Array(r),i=typeof t=="string"?t.split(""):t,s=0;s<r;s++)s in i&&(n[s]=e.call(void 0,i[s],s,t));return n},D={},V=null;function st(t){var e=t.length,r=3*e/4;r%3?r=Math.floor(r):"=.".indexOf(t[e-1])!=-1&&(r="=.".indexOf(t[e-2])!=-1?r-2:r-1);var n=new Uint8Array(r),i=0;return Bt(t,function(s){n[i++]=s}),i!==r?n.subarray(0,i):n}function Bt(t,e){function r(l){for(;n<t.length;){var g=t.charAt(n++),x=V[g];if(x!=null)return x;if(!/^[\s\xa0]*$/.test(g))throw Error("Unknown base64 encoding at char: "+g)}return l}at();for(var n=0;;){var i=r(-1),s=r(0),o=r(64),c=r(64);if(c===64&&i===-1)break;e(i<<2|s>>4),o!=64&&(e(s<<4&240|o>>2),c!=64&&e(o<<6&192|c))}}function at(){if(!V){V={};for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),e=["+/=","+/","-_=","-_.","-_"],r=0;5>r;r++){var n=t.concat(e[r].split(""));D[r]=n;for(var i=0;i<n.length;i++){var s=n[i];V[s]===void 0&&(V[s]=i)}}}}var ct=typeof Uint8Array<"u",bt=!(w("Trident")||w("MSIE"))&&typeof N.btoa=="function";function jt(t){if(!bt){var e;e===void 0&&(e=0),at(),e=D[e];for(var r=Array(Math.floor(t.length/3)),n=e[64]||"",i=0,s=0;i<t.length-2;i+=3){var o=t[i],c=t[i+1],l=t[i+2],g=e[o>>2];o=e[(o&3)<<4|c>>4],c=e[(c&15)<<2|l>>6],l=e[l&63],r[s++]=g+o+c+l}switch(g=0,l=n,t.length-i){case 2:g=t[i+1],l=e[(g&15)<<2]||n;case 1:t=t[i],r[s]=e[t>>2]+e[(t&3)<<4|g>>4]+l+n}return r.join("")}for(e="";10240<t.length;)e+=String.fromCharCode.apply(null,t.subarray(0,10240)),t=t.subarray(10240);return e+=String.fromCharCode.apply(null,t),btoa(e)}var je=RegExp("[-_.]","g");function Fr(t){switch(t){case"-":return"+";case"_":return"/";case".":return"=";default:return""}}function Pe(t){if(!bt)return st(t);je.test(t)&&(t=t.replace(je,Fr)),t=atob(t);for(var e=new Uint8Array(t.length),r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}var Te;function te(){return Te||(Te=new Uint8Array(0))}var Ct={},Lr=typeof Uint8Array.prototype.slice=="function",J=0,nt=0;function Me(t){var e=0>t;t=Math.abs(t);var r=t>>>0;t=Math.floor((t-r)/4294967296),e&&(r=y(Oe(r,t)),e=r.next().value,t=r.next().value,r=e),J=r>>>0,nt=t>>>0}var Rr=typeof BigInt=="function";function Oe(t,e){return e=~e,t?t=~t+1:e+=1,[t,e]}function Be(t,e){this.i=t>>>0,this.h=e>>>0}function Ce(t){if(!t)return Ue||(Ue=new Be(0,0));if(!/^-?\d+$/.test(t))return null;if(16>t.length)Me(Number(t));else if(Rr)t=BigInt(t),J=Number(t&BigInt(4294967295))>>>0,nt=Number(t>>BigInt(32)&BigInt(4294967295));else{var e=+(t[0]==="-");nt=J=0;for(var r=t.length,n=e,i=(r-e)%6+e;i<=r;n=i,i+=6)n=Number(t.slice(n,i)),nt*=1e6,J=1e6*J+n,4294967296<=J&&(nt+=J/4294967296|0,J%=4294967296);e&&(e=y(Oe(J,nt)),t=e.next().value,e=e.next().value,J=t,nt=e)}return new Be(J,nt)}var Ue;function Fe(t,e){return Error("Invalid wire type: "+t+" (at position "+e+")")}function ee(){return Error("Failed to read varint, encoding is invalid.")}function Le(t,e){return Error("Tried to read past the end of the data "+e+" > "+t)}function xt(){throw Error("Invalid UTF8")}function Re(t,e){return e=String.fromCharCode.apply(null,e),t==null?e:t+e}var Nt=void 0,re,_r=typeof TextDecoder<"u",_e,Ir=typeof TextEncoder<"u",Ie;function De(t){if(t!==Ct)throw Error("illegal external caller")}function Ut(t,e){if(De(e),this.V=t,t!=null&&t.length===0)throw Error("ByteString should be constructed with non-empty values")}function ne(){return Ie||(Ie=new Ut(null,Ct))}function Ge(t){De(Ct);var e=t.V;return e=e==null||ct&&e!=null&&e instanceof Uint8Array?e:typeof e=="string"?Pe(e):null,e==null?e:t.V=e}function Dr(t){if(typeof t=="string")return{buffer:Pe(t),C:!1};if(Array.isArray(t))return{buffer:new Uint8Array(t),C:!1};if(t.constructor===Uint8Array)return{buffer:t,C:!1};if(t.constructor===ArrayBuffer)return{buffer:new Uint8Array(t),C:!1};if(t.constructor===Ut)return{buffer:Ge(t)||te(),C:!0};if(t instanceof Uint8Array)return{buffer:new Uint8Array(t.buffer,t.byteOffset,t.byteLength),C:!1};throw Error("Type not convertible to a Uint8Array, expected a Uint8Array, an ArrayBuffer, a base64 encoded string, a ByteString or an Array of numbers")}function Ne(t,e){this.i=null,this.m=!1,this.h=this.j=this.l=0,ie(this,t,e)}function ie(t,e,r){r=r===void 0?{}:r,t.S=r.S===void 0?!1:r.S,e&&(e=Dr(e),t.i=e.buffer,t.m=e.C,t.l=0,t.j=t.i.length,t.h=t.l)}Ne.prototype.reset=function(){this.h=this.l};function St(t,e){if(t.h=e,e>t.j)throw Le(t.j,e)}function Ft(t){var e=t.i,r=t.h,n=e[r++],i=n&127;if(n&128&&(n=e[r++],i|=(n&127)<<7,n&128&&(n=e[r++],i|=(n&127)<<14,n&128&&(n=e[r++],i|=(n&127)<<21,n&128&&(n=e[r++],i|=n<<28,n&128&&e[r++]&128&&e[r++]&128&&e[r++]&128&&e[r++]&128&&e[r++]&128)))))throw ee();return St(t,r),i}function ke(t,e){if(0>e)throw Error("Tried to read a negative byte length: "+e);var r=t.h,n=r+e;if(n>t.j)throw Le(e,t.j-r);return t.h=n,r}var He=[];function oe(){this.h=[]}oe.prototype.length=function(){return this.h.length},oe.prototype.end=function(){var t=this.h;return this.h=[],t};function ze(t,e,r){for(;0<r||127<e;)t.h.push(e&127|128),e=(e>>>7|r<<25)>>>0,r>>>=7;t.h.push(e)}function At(t,e){for(;127<e;)t.h.push(e&127|128),e>>>=7;t.h.push(e)}function se(t,e){if(He.length){var r=He.pop();ie(r,t,e),t=r}else t=new Ne(t,e);this.h=t,this.j=this.h.h,this.i=this.l=-1,this.setOptions(e)}se.prototype.setOptions=function(t){t=t===void 0?{}:t,this.ca=t.ca===void 0?!1:t.ca},se.prototype.reset=function(){this.h.reset(),this.j=this.h.h,this.i=this.l=-1};function Ve(t){var e=t.h;if(e.h==e.j)return!1;t.j=t.h.h;var r=Ft(t.h)>>>0;if(e=r>>>3,r&=7,!(0<=r&&5>=r))throw Fe(r,t.j);if(1>e)throw Error("Invalid field number: "+e+" (at position "+t.j+")");return t.l=e,t.i=r,!0}function kt(t){switch(t.i){case 0:if(t.i!=0)kt(t);else t:{t=t.h;for(var e=t.h,r=e+10,n=t.i;e<r;)if((n[e++]&128)===0){St(t,e);break t}throw ee()}break;case 1:t=t.h,St(t,t.h+8);break;case 2:t.i!=2?kt(t):(e=Ft(t.h)>>>0,t=t.h,St(t,t.h+e));break;case 5:t=t.h,St(t,t.h+4);break;case 3:e=t.l;do{if(!Ve(t))throw Error("Unmatched start-group tag: stream EOF");if(t.i==4){if(t.l!=e)throw Error("Unmatched end-group tag");break}kt(t)}while(!0);break;default:throw Fe(t.i,t.j)}}var Ht=[];function Gr(){this.j=[],this.i=0,this.h=new oe}function Pt(t,e){e.length!==0&&(t.j.push(e),t.i+=e.length)}function Nr(t,e){if(e=e.R){Pt(t,t.h.end());for(var r=0;r<e.length;r++)Pt(t,Ge(e[r])||te())}}var gt=typeof Symbol=="function"&&typeof Symbol()=="symbol"?Symbol():void 0;function Et(t,e){return gt?t[gt]|=e:t.A!==void 0?t.A|=e:(Object.defineProperties(t,{A:{value:e,configurable:!0,writable:!0,enumerable:!1}}),e)}function We(t,e){gt?t[gt]&&(t[gt]&=~e):t.A!==void 0&&(t.A&=~e)}function K(t){var e;return gt?e=t[gt]:e=t.A,e??0}function ft(t,e){gt?t[gt]=e:t.A!==void 0?t.A=e:Object.defineProperties(t,{A:{value:e,configurable:!0,writable:!0,enumerable:!1}})}function ae(t){return Et(t,1),t}function kr(t,e){ft(e,(t|0)&-51)}function zt(t,e){ft(e,(t|18)&-41)}var ue={};function Vt(t){return t!==null&&typeof t=="object"&&!Array.isArray(t)&&t.constructor===Object}var Lt,Xe=[];ft(Xe,23),Lt=Object.freeze(Xe);function ce(t){if(K(t.o)&2)throw Error("Cannot mutate an immutable Message")}function he(t){var e=t.length;(e=e?t[e-1]:void 0)&&Vt(e)?e.g=1:(e={},t.push((e.g=1,e)))}function Ye(t){var e=t.i+t.G;return t.B||(t.B=t.o[e]={})}function ht(t,e){return e===-1?null:e>=t.i?t.B?t.B[e]:void 0:t.o[e+t.G]}function dt(t,e,r,n){ce(t),Rt(t,e,r,n)}function Rt(t,e,r,n){t.j&&(t.j=void 0),e>=t.i||n?Ye(t)[e]=r:(t.o[e+t.G]=r,(t=t.B)&&e in t&&delete t[e])}function le(t,e,r,n){var i=ht(t,e);Array.isArray(i)||(i=Lt);var s=K(i);if(s&1||ae(i),n)s&2||Et(i,2),r&1||Object.freeze(i);else{n=!(r&2);var o=s&2;r&1||!o?n&&s&16&&!o&&We(i,16):(i=ae(Array.prototype.slice.call(i)),Rt(t,e,i))}return i}function fe(t,e){var r=ht(t,e),n=r==null?r:typeof r=="number"||r==="NaN"||r==="Infinity"||r==="-Infinity"?Number(r):void 0;return n!=null&&n!==r&&Rt(t,e,n),n}function $e(t,e,r,n,i){t.h||(t.h={});var s=t.h[r],o=le(t,r,3,i);if(!s){var c=o;s=[];var l=!!(K(t.o)&16);o=!!(K(c)&2);var g=c;!i&&o&&(c=Array.prototype.slice.call(c));for(var x=o,O=0;O<c.length;O++){var b=c[O],A=e,B=!1;if(B=B===void 0?!1:B,b=Array.isArray(b)?new A(b):B?new A:void 0,b!==void 0){A=b.o;var _=B=K(A);o&&(_|=2),l&&(_|=16),_!=B&&ft(A,_),A=_,x=x||!!(2&A),s.push(b)}}return t.h[r]=s,l=K(c),e=l|33,e=x?e&-9:e|8,l!=e&&(x=c,Object.isFrozen(x)&&(x=Array.prototype.slice.call(x)),ft(x,e),c=x),g!==c&&Rt(t,r,c),(i||n&&o)&&Et(s,2),n&&Object.freeze(s),s}return i||(i=Object.isFrozen(s),n&&!i?Object.freeze(s):!n&&i&&(s=Array.prototype.slice.call(s),t.h[r]=s)),s}function Wt(t,e,r){var n=!!(K(t.o)&2);if(e=$e(t,e,r,n,n),t=le(t,r,3,n),!(n||K(t)&8)){for(n=0;n<e.length;n++){if(r=e[n],K(r.o)&2){var i=tr(r,!1);i.j=r}else i=r;r!==i&&(e[n]=i,t[n]=i.o)}Et(t,8)}return e}function pt(t,e,r){if(r!=null&&typeof r!="number")throw Error("Value of float/double field must be a number|null|undefined, found "+typeof r+": "+r);dt(t,e,r)}function Ke(t,e,r,n,i){ce(t);var s=$e(t,r,e,!1,!1);return r=n??new r,t=le(t,e,2,!1),i!=null?(s.splice(i,0,r),t.splice(i,0,r.o)):(s.push(r),t.push(r.o)),r.C()&&We(t,8),r}function Xt(t,e){return t??e}function vt(t,e,r){return r=r===void 0?0:r,Xt(fe(t,e),r)}var Yt;function Hr(t){switch(typeof t){case"number":return isFinite(t)?t:String(t);case"object":if(t)if(Array.isArray(t)){if((K(t)&128)!==0)return t=Array.prototype.slice.call(t),he(t),t}else{if(ct&&t!=null&&t instanceof Uint8Array)return jt(t);if(t instanceof Ut){var e=t.V;return e==null?"":typeof e=="string"?e:t.V=jt(e)}}}return t}function Ze(t,e,r,n){if(t!=null){if(Array.isArray(t))t=de(t,e,r,n!==void 0);else if(Vt(t)){var i={},s;for(s in t)i[s]=Ze(t[s],e,r,n);t=i}else t=e(t,n);return t}}function de(t,e,r,n){var i=K(t);n=n?!!(i&16):void 0,t=Array.prototype.slice.call(t);for(var s=0;s<t.length;s++)t[s]=Ze(t[s],e,r,n);return r(i,t),t}function zr(t){return t.ja===ue?t.toJSON():Hr(t)}function Vr(t,e){t&128&&he(e)}function Qe(t,e,r){if(r=r===void 0?zt:r,t!=null){if(ct&&t instanceof Uint8Array)return t.length?new Ut(new Uint8Array(t),Ct):ne();if(Array.isArray(t)){var n=K(t);return n&2?t:e&&!(n&32)&&(n&16||n===0)?(ft(t,n|2),t):(t=de(t,Qe,n&4?zt:r,!0),e=K(t),e&4&&e&2&&Object.freeze(t),t)}return t.ja===ue?qe(t):t}}function Je(t,e,r,n,i,s,o){if(t=t.h&&t.h[r]){if(n=K(t),n&2?n=t:(s=M(t,qe),zt(n,s),Object.freeze(s),n=s),ce(e),o=n==null?Lt:ae([]),n!=null){for(s=!!n.length,t=0;t<n.length;t++){var c=n[t];s=s&&!(K(c.o)&2),o[t]=c.o}s=(s?8:0)|1,t=K(o),(t&s)!==s&&(Object.isFrozen(o)&&(o=Array.prototype.slice.call(o)),ft(o,t|s)),e.h||(e.h={}),e.h[r]=n}else e.h&&(e.h[r]=void 0);Rt(e,r,o,i)}else dt(e,r,Qe(n,s,o),i)}function qe(t){return K(t.o)&2||(t=tr(t,!0),Et(t.o,2)),t}function tr(t,e){var r=t.o,n=[];Et(n,16);var i=t.constructor.h;if(i&&n.push(i),i=t.B,i){n.length=r.length,n.fill(void 0,n.length,r.length);var s={};n[n.length-1]=s}(K(r)&128)!==0&&he(n),e=e||t.C()?zt:kr,s=t.constructor,Yt=n,n=new s(n),Yt=void 0,t.R&&(n.R=t.R.slice()),s=!!(K(r)&16);for(var o=i?r.length-1:r.length,c=0;c<o;c++)Je(t,n,c-t.G,r[c],!1,s,e);if(i)for(var l in i)Je(t,n,+l,i[l],!0,s,e);return n}function it(t,e,r){t==null&&(t=Yt),Yt=void 0;var n=this.constructor.i||0,i=0<n,s=this.constructor.h,o=!1;if(t==null){t=s?[s]:[];var c=48,l=!0;i&&(n=0,c|=128),ft(t,c)}else{if(!Array.isArray(t)||s&&s!==t[0])throw Error();var g=c=Et(t,0);if((l=(16&g)!==0)&&((o=(32&g)!==0)||(g|=32)),i){if(128&g)n=0;else if(0<t.length){var x=t[t.length-1];if(Vt(x)&&"g"in x){n=0,g|=128,delete x.g;var O=!0,b;for(b in x){O=!1;break}O&&t.pop()}}}else if(128&g)throw Error();c!==g&&ft(t,g)}this.G=(s?0:-1)-n,this.h=void 0,this.o=t;t:{if(s=this.o.length,n=s-1,s&&(s=this.o[n],Vt(s))){this.B=s,this.i=n-this.G;break t}e!==void 0&&-1<e?(this.i=Math.max(e,n+1-this.G),this.B=void 0):this.i=Number.MAX_VALUE}if(!i&&this.B&&"g"in this.B)throw Error('Unexpected "g" flag in sparse object of message that is not a group type.');if(r){e=l&&!o&&!0,i=this.i;var A;for(l=0;l<r.length;l++)o=r[l],o<i?(o+=this.G,(n=t[o])?er(n,e):t[o]=Lt):(A||(A=Ye(this)),(n=A[o])?er(n,e):A[o]=Lt)}}it.prototype.toJSON=function(){return de(this.o,zr,Vr)},it.prototype.C=function(){return!!(K(this.o)&2)};function er(t,e){if(Array.isArray(t)){var r=K(t),n=1;!e||r&2||(n|=16),(r&n)!==n&&ft(t,r|n)}}it.prototype.ja=ue,it.prototype.toString=function(){return this.o.toString()};function rr(t,e,r){if(r){var n={},i;for(i in r){var s=r[i],o=s.qa;o||(n.J=s.wa||s.oa.W,s.ia?(n.aa=ar(s.ia),o=(function(c){return function(l,g,x){return c.J(l,g,x,c.aa)}})(n)):s.ka?(n.Z=ur(s.da.P,s.ka),o=(function(c){return function(l,g,x){return c.J(l,g,x,c.Z)}})(n)):o=n.J,s.qa=o),o(e,t,s.da),n={J:n.J,aa:n.aa,Z:n.Z}}}Nr(e,t)}var $t=Symbol();function nr(t,e,r){return t[$t]||(t[$t]=function(n,i){return e(n,i,r)})}function ir(t){var e=t[$t];if(!e){var r=ve(t);e=function(n,i){return cr(n,i,r)},t[$t]=e}return e}function Wr(t){var e=t.ia;if(e)return ir(e);if(e=t.va)return nr(t.da.P,e,t.ka)}function Xr(t){var e=Wr(t),r=t.da,n=t.oa.U;return e?function(i,s){return n(i,s,r,e)}:function(i,s){return n(i,s,r)}}function or(t,e){var r=t[e];return typeof r=="function"&&r.length===0&&(r=r(),t[e]=r),Array.isArray(r)&&(It in r||_t in r||0<r.length&&typeof r[0]=="function")?r:void 0}function sr(t,e,r,n,i,s){e.P=t[0];var o=1;if(t.length>o&&typeof t[o]!="number"){var c=t[o++];r(e,c)}for(;o<t.length;){r=t[o++];for(var l=o+1;l<t.length&&typeof t[l]!="number";)l++;switch(c=t[o++],l-=o,l){case 0:n(e,r,c);break;case 1:(l=or(t,o))?(o++,i(e,r,c,l)):n(e,r,c,t[o++]);break;case 2:l=o++,l=or(t,l),i(e,r,c,l,t[o++]);break;case 3:s(e,r,c,t[o++],t[o++],t[o++]);break;case 4:s(e,r,c,t[o++],t[o++],t[o++],t[o++]);break;default:throw Error("unexpected number of binary field arguments: "+l)}}return e}var Kt=Symbol();function ar(t){var e=t[Kt];if(!e){var r=pe(t);e=function(n,i){return hr(n,i,r)},t[Kt]=e}return e}function ur(t,e){var r=t[Kt];return r||(r=function(n,i){return rr(n,i,e)},t[Kt]=r),r}var _t=Symbol();function Yr(t,e){t.push(e)}function $r(t,e,r){t.push(e,r.W)}function Kr(t,e,r,n){var i=ar(n),s=pe(n).P,o=r.W;t.push(e,function(c,l,g){return o(c,l,g,s,i)})}function Zr(t,e,r,n,i,s){var o=ur(n,s),c=r.W;t.push(e,function(l,g,x){return c(l,g,x,n,o)})}function pe(t){var e=t[_t];return e||(e=sr(t,t[_t]=[],Yr,$r,Kr,Zr),It in t&&_t in t&&(t.length=0),e)}var It=Symbol();function Qr(t,e){t[0]=e}function Jr(t,e,r,n){var i=r.U;t[e]=n?function(s,o,c){return i(s,o,c,n)}:i}function qr(t,e,r,n,i){var s=r.U,o=ir(n),c=ve(n).P;t[e]=function(l,g,x){return s(l,g,x,c,o,i)}}function tn(t,e,r,n,i,s,o){var c=r.U,l=nr(n,i,s);t[e]=function(g,x,O){return c(g,x,O,n,l,o)}}function ve(t){var e=t[It];return e||(e=sr(t,t[It]={},Qr,Jr,qr,tn),It in t&&_t in t&&(t.length=0),e)}function cr(t,e,r){for(;Ve(e)&&e.i!=4;){var n=e.l,i=r[n];if(!i){var s=r[0];s&&(s=s[n])&&(i=r[n]=Xr(s))}if(!i||!i(e,t,n)){i=e,n=t,s=i.j,kt(i);var o=i;if(!o.ca){if(i=o.h.h-s,o.h.h=s,o=o.h,i==0)i=ne();else{if(s=ke(o,i),o.S&&o.m)i=o.i.subarray(s,s+i);else{o=o.i;var c=s;i=s+i,i=c===i?te():Lr?o.slice(c,i):new Uint8Array(o.subarray(c,i))}i=i.length==0?ne():new Ut(i,Ct)}(s=n.R)?s.push(i):n.R=[i]}}}return t}function hr(t,e,r){for(var n=r.length,i=n%2==1,s=i?1:0;s<n;s+=2)(0,r[s+1])(e,t,r[s]);rr(t,e,i?r[0]:void 0)}function Dt(t,e){return{U:t,W:e}}var lt=Dt(function(t,e,r){if(t.i!==5)return!1;t=t.h;var n=t.i,i=t.h,s=n[i],o=n[i+1],c=n[i+2];return n=n[i+3],St(t,t.h+4),o=(s<<0|o<<8|c<<16|n<<24)>>>0,t=2*(o>>31)+1,s=o>>>23&255,o&=8388607,dt(e,r,s==255?o?NaN:1/0*t:s==0?t*Math.pow(2,-149)*o:t*Math.pow(2,s-150)*(o+Math.pow(2,23))),!0},function(t,e,r){if(e=fe(e,r),e!=null){At(t.h,8*r+5),t=t.h;var n=+e;n===0?0<1/n?J=nt=0:(nt=0,J=2147483648):isNaN(n)?(nt=0,J=2147483647):(n=(r=0>n?-2147483648:0)?-n:n,34028234663852886e22<n?(nt=0,J=(r|2139095040)>>>0):11754943508222875e-54>n?(n=Math.round(n/Math.pow(2,-149)),nt=0,J=(r|n)>>>0):(e=Math.floor(Math.log(n)/Math.LN2),n*=Math.pow(2,-e),n=Math.round(8388608*n),16777216<=n&&++e,nt=0,J=(r|e+127<<23|n&8388607)>>>0)),r=J,t.h.push(r>>>0&255),t.h.push(r>>>8&255),t.h.push(r>>>16&255),t.h.push(r>>>24&255)}}),en=Dt(function(t,e,r){if(t.i!==0)return!1;var n=t.h,i=0,s=t=0,o=n.i,c=n.h;do{var l=o[c++];i|=(l&127)<<s,s+=7}while(32>s&&l&128);for(32<s&&(t|=(l&127)>>4),s=3;32>s&&l&128;s+=7)l=o[c++],t|=(l&127)<<s;if(St(n,c),128>l)n=i>>>0,l=t>>>0,(t=l&2147483648)&&(n=~n+1>>>0,l=~l>>>0,n==0&&(l=l+1>>>0)),n=4294967296*l+(n>>>0);else throw ee();return dt(e,r,t?-n:n),!0},function(t,e,r){e=ht(e,r),e!=null&&(typeof e=="string"&&Ce(e),e!=null&&(At(t.h,8*r),typeof e=="number"?(t=t.h,Me(e),ze(t,J,nt)):(r=Ce(e),ze(t.h,r.i,r.h))))}),rn=Dt(function(t,e,r){return t.i!==0?!1:(dt(e,r,Ft(t.h)),!0)},function(t,e,r){if(e=ht(e,r),e!=null&&e!=null)if(At(t.h,8*r),t=t.h,r=e,0<=r)At(t,r);else{for(e=0;9>e;e++)t.h.push(r&127|128),r>>=7;t.h.push(1)}}),lr=Dt(function(t,e,r){if(t.i!==2)return!1;var n=Ft(t.h)>>>0;t=t.h;var i=ke(t,n);if(t=t.i,_r){var s=t,o;(o=re)||(o=re=new TextDecoder("utf-8",{fatal:!0})),t=i+n,s=i===0&&t===s.length?s:s.subarray(i,t);try{var c=o.decode(s)}catch(O){if(Nt===void 0){try{o.decode(new Uint8Array([128]))}catch{}try{o.decode(new Uint8Array([97])),Nt=!0}catch{Nt=!1}}throw!Nt&&(re=void 0),O}}else{c=i,n=c+n,i=[];for(var l=null,g,x;c<n;)g=t[c++],128>g?i.push(g):224>g?c>=n?xt():(x=t[c++],194>g||(x&192)!==128?(c--,xt()):i.push((g&31)<<6|x&63)):240>g?c>=n-1?xt():(x=t[c++],(x&192)!==128||g===224&&160>x||g===237&&160<=x||((s=t[c++])&192)!==128?(c--,xt()):i.push((g&15)<<12|(x&63)<<6|s&63)):244>=g?c>=n-2?xt():(x=t[c++],(x&192)!==128||(g<<28)+(x-144)>>30!==0||((s=t[c++])&192)!==128||((o=t[c++])&192)!==128?(c--,xt()):(g=(g&7)<<18|(x&63)<<12|(s&63)<<6|o&63,g-=65536,i.push((g>>10&1023)+55296,(g&1023)+56320))):xt(),8192<=i.length&&(l=Re(l,i),i.length=0);c=Re(l,i)}return dt(e,r,c),!0},function(t,e,r){if(e=ht(e,r),e!=null){var n=!1;if(n=n===void 0?!1:n,Ir){if(n&&/(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])/.test(e))throw Error("Found an unpaired surrogate");e=(_e||(_e=new TextEncoder)).encode(e)}else{for(var i=0,s=new Uint8Array(3*e.length),o=0;o<e.length;o++){var c=e.charCodeAt(o);if(128>c)s[i++]=c;else{if(2048>c)s[i++]=c>>6|192;else{if(55296<=c&&57343>=c){if(56319>=c&&o<e.length){var l=e.charCodeAt(++o);if(56320<=l&&57343>=l){c=1024*(c-55296)+l-56320+65536,s[i++]=c>>18|240,s[i++]=c>>12&63|128,s[i++]=c>>6&63|128,s[i++]=c&63|128;continue}else o--}if(n)throw Error("Found an unpaired surrogate");c=65533}s[i++]=c>>12|224,s[i++]=c>>6&63|128}s[i++]=c&63|128}}e=i===s.length?s:s.subarray(0,i)}At(t.h,8*r+2),At(t.h,e.length),Pt(t,t.h.end()),Pt(t,e)}}),fr=Dt(function(t,e,r,n,i){if(t.i!==2)return!1;e=Ke(e,r,n),r=t.h.j,n=Ft(t.h)>>>0;var s=t.h.h+n,o=s-r;if(0>=o&&(t.h.j=s,i(e,t,void 0,void 0,void 0),o=s-t.h.h),o)throw Error("Message parsing ended unexpectedly. Expected to read "+(n+" bytes, instead read "+(n-o)+" bytes, either the data ended unexpectedly or the message misreported its own length"));return t.h.h=s,t.h.j=r,!0},function(t,e,r,n,i){if(e=Wt(e,n,r),e!=null)for(n=0;n<e.length;n++){var s=t;At(s.h,8*r+2);var o=s.h.end();Pt(s,o),o.push(s.i),s=o,i(e[n],t),o=t;var c=s.pop();for(c=o.i+o.h.length()-c;127<c;)s.push(c&127|128),c>>>=7,o.i++;s.push(c),o.i++}});function me(t){return function(e,r){t:{if(Ht.length){var n=Ht.pop();n.setOptions(r),ie(n.h,e,r),e=n}else e=new se(e,r);try{var i=ve(t),s=cr(new i.P,e,i);break t}finally{i=e.h,i.i=null,i.m=!1,i.l=0,i.j=0,i.h=0,i.S=!1,e.l=-1,e.i=-1,100>Ht.length&&Ht.push(e)}s=void 0}return s}}function ye(t){return function(){var e=new Gr;hr(this,e,pe(t)),Pt(e,e.h.end());for(var r=new Uint8Array(e.i),n=e.j,i=n.length,s=0,o=0;o<i;o++){var c=n[o];r.set(c,s),s+=c.length}return e.j=[r],r}}function Tt(t){it.call(this,t)}X(Tt,it);var dr=[Tt,1,rn,2,lt,3,lr,4,lr];Tt.prototype.l=ye(dr);function ge(t){it.call(this,t,-1,nn)}X(ge,it),ge.prototype.addClassification=function(t,e){return Ke(this,1,Tt,t,e),this};var nn=[1],pr=me([ge,1,fr,dr]);function Mt(t){it.call(this,t)}X(Mt,it);var vr=[Mt,1,lt,2,lt,3,lt,4,lt,5,lt];Mt.prototype.l=ye(vr);function mr(t){it.call(this,t,-1,on)}X(mr,it);var on=[1],yr=me([mr,1,fr,vr]);function Zt(t){it.call(this,t)}X(Zt,it);var gr=[Zt,1,lt,2,lt,3,lt,4,lt,5,lt,6,en],sn=me(gr);Zt.prototype.l=ye(gr);function wr(t,e,r){if(r=t.createShader(r===0?t.VERTEX_SHADER:t.FRAGMENT_SHADER),t.shaderSource(r,e),t.compileShader(r),!t.getShaderParameter(r,t.COMPILE_STATUS))throw Error(`Could not compile WebGL shader.

`+t.getShaderInfoLog(r));return r}function xr(t){return Wt(t,Tt,1).map(function(e){var r=ht(e,1);return{index:r??0,score:vt(e,2),label:ht(e,3)!=null?Xt(ht(e,3),""):void 0,displayName:ht(e,4)!=null?Xt(ht(e,4),""):void 0}})}function Sr(t){return{x:vt(t,1),y:vt(t,2),z:vt(t,3),visibility:fe(t,4)!=null?vt(t,4):void 0}}function Ar(t){return t.map(function(e){return Wt(yr(e),Mt,1).map(Sr)})}function we(t,e){this.i=t,this.h=e,this.m=0}function Er(t,e,r){return an(t,e),typeof t.h.canvas.transferToImageBitmap=="function"?Promise.resolve(t.h.canvas.transferToImageBitmap()):r?Promise.resolve(t.h.canvas):typeof createImageBitmap=="function"?createImageBitmap(t.h.canvas):(t.j===void 0&&(t.j=document.createElement("canvas")),new Promise(function(n){t.j.height=t.h.canvas.height,t.j.width=t.h.canvas.width,t.j.getContext("2d",{}).drawImage(t.h.canvas,0,0,t.h.canvas.width,t.h.canvas.height),n(t.j)}))}function an(t,e){var r=t.h;if(t.s===void 0){var n=wr(r,`
  attribute vec2 aVertex;
  attribute vec2 aTex;
  varying vec2 vTex;
  void main(void) {
    gl_Position = vec4(aVertex, 0.0, 1.0);
    vTex = aTex;
  }`,0),i=wr(r,`
  precision mediump float;
  varying vec2 vTex;
  uniform sampler2D sampler0;
  void main(){
    gl_FragColor = texture2D(sampler0, vTex);
  }`,1),s=r.createProgram();if(r.attachShader(s,n),r.attachShader(s,i),r.linkProgram(s),!r.getProgramParameter(s,r.LINK_STATUS))throw Error(`Could not compile WebGL program.

`+r.getProgramInfoLog(s));n=t.s=s,r.useProgram(n),i=r.getUniformLocation(n,"sampler0"),t.l={O:r.getAttribLocation(n,"aVertex"),N:r.getAttribLocation(n,"aTex"),xa:i},t.v=r.createBuffer(),r.bindBuffer(r.ARRAY_BUFFER,t.v),r.enableVertexAttribArray(t.l.O),r.vertexAttribPointer(t.l.O,2,r.FLOAT,!1,0,0),r.bufferData(r.ARRAY_BUFFER,new Float32Array([-1,-1,-1,1,1,1,1,-1]),r.STATIC_DRAW),r.bindBuffer(r.ARRAY_BUFFER,null),t.u=r.createBuffer(),r.bindBuffer(r.ARRAY_BUFFER,t.u),r.enableVertexAttribArray(t.l.N),r.vertexAttribPointer(t.l.N,2,r.FLOAT,!1,0,0),r.bufferData(r.ARRAY_BUFFER,new Float32Array([0,1,0,0,1,0,1,1]),r.STATIC_DRAW),r.bindBuffer(r.ARRAY_BUFFER,null),r.uniform1i(i,0)}n=t.l,r.useProgram(t.s),r.canvas.width=e.width,r.canvas.height=e.height,r.viewport(0,0,e.width,e.height),r.activeTexture(r.TEXTURE0),t.i.bindTexture2d(e.glName),r.enableVertexAttribArray(n.O),r.bindBuffer(r.ARRAY_BUFFER,t.v),r.vertexAttribPointer(n.O,2,r.FLOAT,!1,0,0),r.enableVertexAttribArray(n.N),r.bindBuffer(r.ARRAY_BUFFER,t.u),r.vertexAttribPointer(n.N,2,r.FLOAT,!1,0,0),r.bindFramebuffer(r.DRAW_FRAMEBUFFER?r.DRAW_FRAMEBUFFER:r.FRAMEBUFFER,null),r.clearColor(0,0,0,0),r.clear(r.COLOR_BUFFER_BIT),r.colorMask(!0,!0,!0,!0),r.drawArrays(r.TRIANGLE_FAN,0,4),r.disableVertexAttribArray(n.O),r.disableVertexAttribArray(n.N),r.bindBuffer(r.ARRAY_BUFFER,null),t.i.bindTexture2d(0)}function un(t){this.h=t}var cn=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,9,1,7,0,65,0,253,15,26,11]);function hn(t,e){return e+t}function br(t,e){window[t]=e}function ln(t){var e=document.createElement("script");return e.setAttribute("src",t),e.setAttribute("crossorigin","anonymous"),new Promise(function(r){e.addEventListener("load",function(){r()},!1),e.addEventListener("error",function(){r()},!1),document.body.appendChild(e)})}function fn(){return v(function(t){switch(t.h){case 1:return t.s=2,T(t,WebAssembly.instantiate(cn),4);case 4:t.h=3,t.s=0;break;case 2:return t.s=0,t.l=null,t.return(!1);case 3:return t.return(!0)}})}function xe(t){if(this.h=t,this.listeners={},this.l={},this.L={},this.s={},this.v={},this.M=this.u=this.ga=!0,this.I=Promise.resolve(),this.fa="",this.D={},this.locateFile=t&&t.locateFile||hn,typeof window=="object")var e=window.location.pathname.toString().substring(0,window.location.pathname.toString().lastIndexOf("/"))+"/";else if(typeof location<"u")e=location.pathname.toString().substring(0,location.pathname.toString().lastIndexOf("/"))+"/";else throw Error("solutions can only be loaded on a web page or in a web worker");if(this.ha=e,t.options){e=y(Object.keys(t.options));for(var r=e.next();!r.done;r=e.next()){r=r.value;var n=t.options[r].default;n!==void 0&&(this.l[r]=typeof n=="function"?n():n)}}}u=xe.prototype,u.close=function(){return this.j&&this.j.delete(),Promise.resolve()};function dn(t){var e,r,n,i,s,o,c,l,g,x,O;return v(function(b){switch(b.h){case 1:return t.ga?(e=t.h.files===void 0?[]:typeof t.h.files=="function"?t.h.files(t.l):t.h.files,T(b,fn(),2)):b.return();case 2:if(r=b.i,typeof window=="object")return br("createMediapipeSolutionsWasm",{locateFile:t.locateFile}),br("createMediapipeSolutionsPackedAssets",{locateFile:t.locateFile}),o=e.filter(function(A){return A.data!==void 0}),c=e.filter(function(A){return A.data===void 0}),l=Promise.all(o.map(function(A){var B=Qt(t,A.url);if(A.path!==void 0){var _=A.path;B=B.then(function(W){return t.overrideFile(_,W),Promise.resolve(W)})}return B})),g=Promise.all(c.map(function(A){return A.simd===void 0||A.simd&&r||!A.simd&&!r?ln(t.locateFile(A.url,t.ha)):Promise.resolve()})).then(function(){var A,B,_;return v(function(W){if(W.h==1)return A=window.createMediapipeSolutionsWasm,B=window.createMediapipeSolutionsPackedAssets,_=t,T(W,A(B),2);_.i=W.i,W.h=0})}),x=(function(){return v(function(A){return t.h.graph&&t.h.graph.url?A=T(A,Qt(t,t.h.graph.url),0):(A.h=0,A=void 0),A})})(),T(b,Promise.all([g,l,x]),7);if(typeof importScripts!="function")throw Error("solutions can only be loaded on a web page or in a web worker");return n=e.filter(function(A){return A.simd===void 0||A.simd&&r||!A.simd&&!r}).map(function(A){return t.locateFile(A.url,t.ha)}),importScripts.apply(null,E(n)),i=t,T(b,createMediapipeSolutionsWasm(Module),6);case 6:i.i=b.i,t.m=new OffscreenCanvas(1,1),t.i.canvas=t.m,s=t.i.GL.createContext(t.m,{antialias:!1,alpha:!1,ua:typeof WebGL2RenderingContext<"u"?2:1}),t.i.GL.makeContextCurrent(s),b.h=4;break;case 7:if(t.m=document.createElement("canvas"),O=t.m.getContext("webgl2",{}),!O&&(O=t.m.getContext("webgl",{}),!O))return alert("Failed to create WebGL canvas context when passing video frame."),b.return();t.K=O,t.i.canvas=t.m,t.i.createContext(t.m,!0,!0,{});case 4:t.j=new t.i.SolutionWasm,t.ga=!1,b.h=0}})}function pn(t){var e,r,n,i,s,o,c,l;return v(function(g){if(g.h==1){if(t.h.graph&&t.h.graph.url&&t.fa===t.h.graph.url)return g.return();if(t.u=!0,!t.h.graph||!t.h.graph.url){g.h=2;return}return t.fa=t.h.graph.url,T(g,Qt(t,t.h.graph.url),3)}for(g.h!=2&&(e=g.i,t.j.loadGraph(e)),r=y(Object.keys(t.D)),n=r.next();!n.done;n=r.next())i=n.value,t.j.overrideFile(i,t.D[i]);if(t.D={},t.h.listeners)for(s=y(t.h.listeners),o=s.next();!o.done;o=s.next())c=o.value,gn(t,c);l=t.l,t.l={},t.setOptions(l),g.h=0})}u.reset=function(){var t=this;return v(function(e){t.j&&(t.j.reset(),t.s={},t.v={}),e.h=0})},u.setOptions=function(t,e){var r=this;if(e=e||this.h.options){for(var n=[],i=[],s={},o=y(Object.keys(t)),c=o.next();!c.done;s={X:s.X,Y:s.Y},c=o.next())if(c=c.value,!(c in this.l&&this.l[c]===t[c])){this.l[c]=t[c];var l=e[c];l!==void 0&&(l.onChange&&(s.X=l.onChange,s.Y=t[c],n.push((function(g){return function(){var x;return v(function(O){if(O.h==1)return T(O,g.X(g.Y),2);x=O.i,x===!0&&(r.u=!0),O.h=0})}})(s))),l.graphOptionXref&&(c=Object.assign({},{calculatorName:"",calculatorIndex:0},l.graphOptionXref,{valueNumber:l.type===1?t[c]:0,valueBoolean:l.type===0?t[c]:!1,valueString:l.type===2?t[c]:""}),i.push(c)))}(n.length!==0||i.length!==0)&&(this.u=!0,this.H=(this.H===void 0?[]:this.H).concat(i),this.F=(this.F===void 0?[]:this.F).concat(n))}};function vn(t){var e,r,n,i,s,o,c;return v(function(l){switch(l.h){case 1:if(!t.u)return l.return();if(!t.F){l.h=2;break}e=y(t.F),r=e.next();case 3:if(r.done){l.h=5;break}return n=r.value,T(l,n(),4);case 4:r=e.next(),l.h=3;break;case 5:t.F=void 0;case 2:if(t.H){for(i=new t.i.GraphOptionChangeRequestList,s=y(t.H),o=s.next();!o.done;o=s.next())c=o.value,i.push_back(c);t.j.changeOptions(i),i.delete(),t.H=void 0}t.u=!1,l.h=0}})}u.initialize=function(){var t=this;return v(function(e){return e.h==1?T(e,dn(t),2):e.h!=3?T(e,pn(t),3):T(e,vn(t),0)})};function Qt(t,e){var r,n;return v(function(i){return e in t.L?i.return(t.L[e]):(r=t.locateFile(e,""),n=fetch(r).then(function(s){return s.arrayBuffer()}),t.L[e]=n,i.return(n))})}u.overrideFile=function(t,e){this.j?this.j.overrideFile(t,e):this.D[t]=e},u.clearOverriddenFiles=function(){this.D={},this.j&&this.j.clearOverriddenFiles()},u.send=function(t,e){var r=this,n,i,s,o,c,l,g,x,O;return v(function(b){switch(b.h){case 1:return r.h.inputs?(n=1e3*(e??performance.now()),T(b,r.I,2)):b.return();case 2:return T(b,r.initialize(),3);case 3:for(i=new r.i.PacketDataList,s=y(Object.keys(t)),o=s.next();!o.done;o=s.next())if(c=o.value,l=r.h.inputs[c]){t:{var A=t[c];switch(l.type){case"video":var B=r.s[l.stream];if(B||(B=new we(r.i,r.K),r.s[l.stream]=B),B.m===0&&(B.m=B.i.createTexture()),typeof HTMLVideoElement<"u"&&A instanceof HTMLVideoElement)var _=A.videoWidth,W=A.videoHeight;else typeof HTMLImageElement<"u"&&A instanceof HTMLImageElement?(_=A.naturalWidth,W=A.naturalHeight):(_=A.width,W=A.height);W={glName:B.m,width:_,height:W},_=B.h,_.canvas.width=W.width,_.canvas.height=W.height,_.activeTexture(_.TEXTURE0),B.i.bindTexture2d(B.m),_.texImage2D(_.TEXTURE_2D,0,_.RGBA,_.RGBA,_.UNSIGNED_BYTE,A),B.i.bindTexture2d(0),B=W;break t;case"detections":for(B=r.s[l.stream],B||(B=new un(r.i),r.s[l.stream]=B),B.data||(B.data=new B.h.DetectionListData),B.data.reset(A.length),W=0;W<A.length;++W){_=A[W];var z=B.data,q=z.setBoundingBox,ut=W,ot=_.la,G=new Zt;if(pt(G,1,ot.ra),pt(G,2,ot.sa),pt(G,3,ot.height),pt(G,4,ot.width),pt(G,5,ot.rotation),dt(G,6,ot.pa),ot=G.l(),q.call(z,ut,ot),_.ea)for(z=0;z<_.ea.length;++z){G=_.ea[z],q=B.data,ut=q.addNormalizedLandmark,ot=W,G=Object.assign({},G,{visibility:G.visibility?G.visibility:0});var tt=new Mt;pt(tt,1,G.x),pt(tt,2,G.y),pt(tt,3,G.z),G.visibility&&pt(tt,4,G.visibility),G=tt.l(),ut.call(q,ot,G)}if(_.ba)for(z=0;z<_.ba.length;++z)q=B.data,ut=q.addClassification,ot=W,G=_.ba[z],tt=new Tt,pt(tt,2,G.score),G.index&&dt(tt,1,G.index),G.label&&dt(tt,3,G.label),G.displayName&&dt(tt,4,G.displayName),G=tt.l(),ut.call(q,ot,G)}B=B.data;break t;default:B={}}}switch(g=B,x=l.stream,l.type){case"video":i.pushTexture2d(Object.assign({},g,{stream:x,timestamp:n}));break;case"detections":O=g,O.stream=x,O.timestamp=n,i.pushDetectionList(O);break;default:throw Error("Unknown input config type: '"+l.type+"'")}}return r.j.send(i),T(b,r.I,4);case 4:i.delete(),b.h=0}})};function mn(t,e,r){var n,i,s,o,c,l,g,x,O,b,A,B,_,W;return v(function(z){switch(z.h){case 1:if(!r)return z.return(e);for(n={},i=0,s=y(Object.keys(r)),o=s.next();!o.done;o=s.next())c=o.value,l=r[c],typeof l!="string"&&l.type==="texture"&&e[l.stream]!==void 0&&++i;1<i&&(t.M=!1),g=y(Object.keys(r)),o=g.next();case 2:if(o.done){z.h=4;break}if(x=o.value,O=r[x],typeof O=="string")return _=n,W=x,T(z,yn(t,x,e[O]),14);if(b=e[O.stream],O.type==="detection_list"){if(b){for(var q=b.getRectList(),ut=b.getLandmarksList(),ot=b.getClassificationsList(),G=[],tt=0;tt<q.size();++tt){var wt=sn(q.get(tt)),wn=vt(wt,1),xn=vt(wt,2),Sn=vt(wt,3),An=vt(wt,4),En=vt(wt,5,0),Jt=void 0;Jt=Jt===void 0?0:Jt,wt={la:{ra:wn,sa:xn,height:Sn,width:An,rotation:En,pa:Xt(ht(wt,6),Jt)},ea:Wt(yr(ut.get(tt)),Mt,1).map(Sr),ba:xr(pr(ot.get(tt)))},G.push(wt)}q=G}else q=[];n[x]=q,z.h=7;break}if(O.type==="proto_list"){if(b){for(q=Array(b.size()),ut=0;ut<b.size();ut++)q[ut]=b.get(ut);b.delete()}else q=[];n[x]=q,z.h=7;break}if(b===void 0){z.h=3;break}if(O.type==="float_list"){n[x]=b,z.h=7;break}if(O.type==="proto"){n[x]=b,z.h=7;break}if(O.type!=="texture")throw Error("Unknown output config type: '"+O.type+"'");return A=t.v[x],A||(A=new we(t.i,t.K),t.v[x]=A),T(z,Er(A,b,t.M),13);case 13:B=z.i,n[x]=B;case 7:O.transform&&n[x]&&(n[x]=O.transform(n[x])),z.h=3;break;case 14:_[W]=z.i;case 3:o=g.next(),z.h=2;break;case 4:return z.return(n)}})}function yn(t,e,r){var n;return v(function(i){return typeof r=="number"||r instanceof Uint8Array||r instanceof t.i.Uint8BlobList?i.return(r):r instanceof t.i.Texture2dDataOut?(n=t.v[e],n||(n=new we(t.i,t.K),t.v[e]=n),i.return(Er(n,r,t.M))):i.return(void 0)})}function gn(t,e){for(var r=e.name||"$",n=[].concat(E(e.wants)),i=new t.i.StringList,s=y(e.wants),o=s.next();!o.done;o=s.next())i.push_back(o.value);s=t.i.PacketListener.implement({onResults:function(c){for(var l={},g=0;g<e.wants.length;++g)l[n[g]]=c.get(g);var x=t.listeners[r];x&&(t.I=mn(t,l,e.outs).then(function(O){O=x(O);for(var b=0;b<e.wants.length;++b){var A=l[n[b]];typeof A=="object"&&A.hasOwnProperty&&A.hasOwnProperty("delete")&&A.delete()}O&&(t.I=O)}))}}),t.j.attachMultiListener(i,s),i.delete()}u.onResults=function(t,e){this.listeners[e||"$"]=t},Z("Solution",xe),Z("OptionType",{BOOL:0,NUMBER:1,ta:2,0:"BOOL",1:"NUMBER",2:"STRING"});function jr(t){return t===void 0&&(t=0),t===1?"hand_landmark_full.tflite":"hand_landmark_lite.tflite"}function Pr(t){var e=this;t=t||{},this.h=new xe({locateFile:t.locateFile,files:function(r){return[{url:"hands_solution_packed_assets_loader.js"},{simd:!1,url:"hands_solution_wasm_bin.js"},{simd:!0,url:"hands_solution_simd_wasm_bin.js"},{data:!0,url:jr(r.modelComplexity)}]},graph:{url:"hands.binarypb"},inputs:{image:{type:"video",stream:"input_frames_gpu"}},listeners:[{wants:["multi_hand_landmarks","multi_hand_world_landmarks","image_transformed","multi_handedness"],outs:{image:"image_transformed",multiHandLandmarks:{type:"proto_list",stream:"multi_hand_landmarks",transform:Ar},multiHandWorldLandmarks:{type:"proto_list",stream:"multi_hand_world_landmarks",transform:Ar},multiHandedness:{type:"proto_list",stream:"multi_handedness",transform:function(r){return r.map(function(n){return xr(pr(n))[0]})}}}}],options:{useCpuInference:{type:0,graphOptionXref:{calculatorType:"InferenceCalculator",fieldName:"use_cpu_inference"},default:typeof window!="object"||window.navigator===void 0?!1:"iPad Simulator;iPhone Simulator;iPod Simulator;iPad;iPhone;iPod".split(";").includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document},selfieMode:{type:0,graphOptionXref:{calculatorType:"GlScalerCalculator",calculatorIndex:1,fieldName:"flip_horizontal"}},maxNumHands:{type:1,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculator",fieldName:"int_value"}},modelComplexity:{type:1,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculatorModelComplexity",fieldName:"int_value"},onChange:function(r){var n,i,s;return v(function(o){return o.h==1?(n=jr(r),i="third_party/mediapipe/modules/hand_landmark/"+n,T(o,Qt(e.h,n),2)):(s=o.i,e.h.overrideFile(i,s),o.return(!0))})}},minDetectionConfidence:{type:1,graphOptionXref:{calculatorType:"TensorsToDetectionsCalculator",calculatorName:"handlandmarktrackinggpu__palmdetectiongpu__TensorsToDetectionsCalculator",fieldName:"min_score_thresh"}},minTrackingConfidence:{type:1,graphOptionXref:{calculatorType:"ThresholdingCalculator",calculatorName:"handlandmarktrackinggpu__handlandmarkgpu__ThresholdingCalculator",fieldName:"threshold"}}}})}u=Pr.prototype,u.close=function(){return this.h.close(),Promise.resolve()},u.onResults=function(t){this.h.onResults(t)},u.initialize=function(){var t=this;return v(function(e){return T(e,t.h.initialize(),0)})},u.reset=function(){this.h.reset()},u.send=function(t){var e=this;return v(function(r){return T(r,e.h.send(t),0)})},u.setOptions=function(t){this.h.setOptions(t)},Z("Hands",Pr),Z("HAND_CONNECTIONS",[[0,1],[1,2],[2,3],[3,4],[0,5],[5,6],[6,7],[7,8],[5,9],[9,10],[10,11],[11,12],[9,13],[13,14],[14,15],[15,16],[13,17],[0,17],[17,18],[18,19],[19,20]]),Z("VERSION","0.4.1675469240")}).call(Ee)),Ee}var Dn=In(),be={},Br;function Gn(){return Br||(Br=1,(function(){function u(f){var v=0;return function(){return v<f.length?{done:!1,value:f[v++]}:{done:!0}}}var a=typeof Object.defineProperties=="function"?Object.defineProperty:function(f,v,C){return f==Array.prototype||f==Object.prototype||(f[v]=C.value),f};function h(f){f=[typeof globalThis=="object"&&globalThis,f,typeof window=="object"&&window,typeof self=="object"&&self,typeof qt=="object"&&qt];for(var v=0;v<f.length;++v){var C=f[v];if(C&&C.Math==Math)return C}throw Error("Cannot find global object")}var d=h(this);function p(f,v){if(v)t:{var C=d;f=f.split(".");for(var j=0;j<f.length-1;j++){var N=f[j];if(!(N in C))break t;C=C[N]}f=f[f.length-1],j=C[f],v=v(j),v!=j&&v!=null&&a(C,f,{configurable:!0,writable:!0,value:v})}}p("Symbol",function(f){function v(Z){if(this instanceof v)throw new TypeError("Symbol is not a constructor");return new C(j+(Z||"")+"_"+N++,Z)}function C(Z,w){this.g=Z,a(this,"description",{configurable:!0,writable:!0,value:w})}if(f)return f;C.prototype.toString=function(){return this.g};var j="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",N=0;return v}),p("Symbol.iterator",function(f){if(f)return f;f=Symbol("Symbol.iterator");for(var v="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),C=0;C<v.length;C++){var j=d[v[C]];typeof j=="function"&&typeof j.prototype[f]!="function"&&a(j.prototype,f,{configurable:!0,writable:!0,value:function(){return m(u(this))}})}return f});function m(f){return f={next:f},f[Symbol.iterator]=function(){return this},f}function S(f){var v=typeof Symbol<"u"&&Symbol.iterator&&f[Symbol.iterator];return v?v.call(f):{next:u(f)}}function y(){this.i=!1,this.g=null,this.o=void 0,this.j=1,this.m=0,this.h=null}function E(f){if(f.i)throw new TypeError("Generator is already running");f.i=!0}y.prototype.l=function(f){this.o=f};function U(f,v){f.h={F:v,G:!0},f.j=f.m}y.prototype.return=function(f){this.h={return:f},this.j=this.m};function P(f){this.g=new y,this.h=f}function F(f,v){E(f.g);var C=f.g.g;return C?R(f,"return"in C?C.return:function(j){return{value:j,done:!0}},v,f.g.return):(f.g.return(v),L(f))}function R(f,v,C,j){try{var N=v.call(f.g.g,C);if(!(N instanceof Object))throw new TypeError("Iterator result "+N+" is not an object");if(!N.done)return f.g.i=!1,N;var Z=N.value}catch(w){return f.g.g=null,U(f.g,w),L(f)}return f.g.g=null,j.call(f.g,Z),L(f)}function L(f){for(;f.g.j;)try{var v=f.h(f.g);if(v)return f.g.i=!1,{value:v.value,done:!1}}catch(C){f.g.o=void 0,U(f.g,C)}if(f.g.i=!1,f.g.h){if(v=f.g.h,f.g.h=null,v.G)throw v.F;return{value:v.return,done:!0}}return{value:void 0,done:!0}}function Y(f){this.next=function(v){return E(f.g),f.g.g?v=R(f,f.g.g.next,v,f.g.l):(f.g.l(v),v=L(f)),v},this.throw=function(v){return E(f.g),f.g.g?v=R(f,f.g.g.throw,v,f.g.l):(U(f.g,v),v=L(f)),v},this.return=function(v){return F(f,v)},this[Symbol.iterator]=function(){return this}}function $(f){function v(j){return f.next(j)}function C(j){return f.throw(j)}return new Promise(function(j,N){function Z(w){w.done?j(w.value):Promise.resolve(w.value).then(v,C).then(Z,N)}Z(f.next())})}p("Promise",function(f){function v(w){this.h=0,this.i=void 0,this.g=[],this.o=!1;var M=this.j();try{w(M.resolve,M.reject)}catch(D){M.reject(D)}}function C(){this.g=null}function j(w){return w instanceof v?w:new v(function(M){M(w)})}if(f)return f;C.prototype.h=function(w){if(this.g==null){this.g=[];var M=this;this.i(function(){M.l()})}this.g.push(w)};var N=d.setTimeout;C.prototype.i=function(w){N(w,0)},C.prototype.l=function(){for(;this.g&&this.g.length;){var w=this.g;this.g=[];for(var M=0;M<w.length;++M){var D=w[M];w[M]=null;try{D()}catch(V){this.j(V)}}}this.g=null},C.prototype.j=function(w){this.i(function(){throw w})},v.prototype.j=function(){function w(V){return function(st){D||(D=!0,V.call(M,st))}}var M=this,D=!1;return{resolve:w(this.A),reject:w(this.l)}},v.prototype.A=function(w){if(w===this)this.l(new TypeError("A Promise cannot resolve to itself"));else if(w instanceof v)this.C(w);else{t:switch(typeof w){case"object":var M=w!=null;break t;case"function":M=!0;break t;default:M=!1}M?this.v(w):this.m(w)}},v.prototype.v=function(w){var M=void 0;try{M=w.then}catch(D){this.l(D);return}typeof M=="function"?this.D(M,w):this.m(w)},v.prototype.l=function(w){this.u(2,w)},v.prototype.m=function(w){this.u(1,w)},v.prototype.u=function(w,M){if(this.h!=0)throw Error("Cannot settle("+w+", "+M+"): Promise already settled in state"+this.h);this.h=w,this.i=M,this.h===2&&this.B(),this.H()},v.prototype.B=function(){var w=this;N(function(){if(w.I()){var M=d.console;typeof M<"u"&&M.error(w.i)}},1)},v.prototype.I=function(){if(this.o)return!1;var w=d.CustomEvent,M=d.Event,D=d.dispatchEvent;return typeof D>"u"?!0:(typeof w=="function"?w=new w("unhandledrejection",{cancelable:!0}):typeof M=="function"?w=new M("unhandledrejection",{cancelable:!0}):(w=d.document.createEvent("CustomEvent"),w.initCustomEvent("unhandledrejection",!1,!0,w)),w.promise=this,w.reason=this.i,D(w))},v.prototype.H=function(){if(this.g!=null){for(var w=0;w<this.g.length;++w)Z.h(this.g[w]);this.g=null}};var Z=new C;return v.prototype.C=function(w){var M=this.j();w.s(M.resolve,M.reject)},v.prototype.D=function(w,M){var D=this.j();try{w.call(M,D.resolve,D.reject)}catch(V){D.reject(V)}},v.prototype.then=function(w,M){function D(at,ct){return typeof at=="function"?function(bt){try{V(at(bt))}catch(jt){st(jt)}}:ct}var V,st,Bt=new v(function(at,ct){V=at,st=ct});return this.s(D(w,V),D(M,st)),Bt},v.prototype.catch=function(w){return this.then(void 0,w)},v.prototype.s=function(w,M){function D(){switch(V.h){case 1:w(V.i);break;case 2:M(V.i);break;default:throw Error("Unexpected state: "+V.h)}}var V=this;this.g==null?Z.h(D):this.g.push(D),this.o=!0},v.resolve=j,v.reject=function(w){return new v(function(M,D){D(w)})},v.race=function(w){return new v(function(M,D){for(var V=S(w),st=V.next();!st.done;st=V.next())j(st.value).s(M,D)})},v.all=function(w){var M=S(w),D=M.next();return D.done?j([]):new v(function(V,st){function Bt(bt){return function(jt){at[bt]=jt,ct--,ct==0&&V(at)}}var at=[],ct=0;do at.push(void 0),ct++,j(D.value).s(Bt(at.length-1),st),D=M.next();while(!D.done)})},v});var X=typeof Object.assign=="function"?Object.assign:function(f,v){for(var C=1;C<arguments.length;C++){var j=arguments[C];if(j)for(var N in j)Object.prototype.hasOwnProperty.call(j,N)&&(f[N]=j[N])}return f};p("Object.assign",function(f){return f||X});var Q=this||self,rt={facingMode:"user",width:640,height:480};function I(f,v){this.video=f,this.i=0,this.h=Object.assign(Object.assign({},rt),v)}I.prototype.stop=function(){var f=this,v,C,j,N;return $(new Y(new P(function(Z){if(f.g){for(v=f.g.getTracks(),C=S(v),j=C.next();!j.done;j=C.next())N=j.value,N.stop();f.g=void 0}Z.j=0})))},I.prototype.start=function(){var f=this,v;return $(new Y(new P(function(C){return navigator.mediaDevices&&navigator.mediaDevices.getUserMedia||alert("No navigator.mediaDevices.getUserMedia exists."),v=f.h,C.return(navigator.mediaDevices.getUserMedia({video:{facingMode:v.facingMode,width:v.width,height:v.height}}).then(function(j){k(f,j)}).catch(function(j){var N="Failed to acquire camera feed: "+j;throw console.error(N),alert(N),j}))})))};function T(f){window.requestAnimationFrame(function(){H(f)})}function k(f,v){f.g=v,f.video.srcObject=v,f.video.onloadedmetadata=function(){f.video.play(),T(f)}}function H(f){var v=null;f.video.paused||f.video.currentTime===f.i||(f.i=f.video.currentTime,v=f.h.onFrame()),v?v.then(function(){T(f)}):T(f)}var mt=["Camera"],et=Q;mt[0]in et||typeof et.execScript>"u"||et.execScript("var "+mt[0]);for(var yt;mt.length&&(yt=mt.shift());)mt.length||I===void 0?et[yt]&&et[yt]!==Object.prototype[yt]?et=et[yt]:et=et[yt]={}:et[yt]=I}).call(be)),be}var Nn=Gn();class kn{constructor(){this.hands=null,this.camera=null,this.video=null,this.isRunning=!1,this.currentHandPos=null,this.smoothedHandPos={x:window.innerWidth/2,y:window.innerHeight/2},this.smoothing=.3,this.handDetected=!1}async init(){this.video=document.createElement("video"),this.video.style.display="none",this.video.width=640,this.video.height=480,document.body.appendChild(this.video),this.hands=new Dn.Hands({locateFile:a=>`https://cdn.jsdelivr.net/npm/@mediapipe/hands/${a}`}),this.hands.setOptions({maxNumHands:1,modelComplexity:1,minDetectionConfidence:.5,minTrackingConfidence:.5}),this.hands.onResults(a=>this.onResults(a))}async start(){this.isRunning||(this.camera=new Nn.Camera(this.video,{onFrame:async()=>{await this.hands.send({image:this.video})},width:640,height:480}),await this.camera.start(),this.isRunning=!0)}onResults(a){if(a.multiHandLandmarks&&a.multiHandLandmarks.length>0){this.handDetected=!0;const d=a.multiHandLandmarks[0][8],p=(1-d.x)*window.innerWidth,m=d.y*window.innerHeight;this.currentHandPos={x:p,y:m},this.smoothedHandPos.x=this.smoothedHandPos.x*(1-this.smoothing)+this.currentHandPos.x*this.smoothing,this.smoothedHandPos.y=this.smoothedHandPos.y*(1-this.smoothing)+this.currentHandPos.y*this.smoothing}else this.handDetected=!1,this.currentHandPos=null}getPointerPosition(){return this.isRunning&&this.currentHandPos?this.smoothedHandPos:null}isHandDetected(){return this.handDetected}stop(){this.isRunning&&(this.camera&&this.camera.stop(),this.isRunning=!1)}destroy(){this.stop(),this.video&&this.video.parentNode&&this.video.parentNode.removeChild(this.video),this.hands&&this.hands.close()}}class Hn{constructor(){this.recognition=null,this.isListening=!1,this.listeners=new Map,this.validCommands=["cube","sphere","torus","pyramid","bang","fire","shoot"]}async init(){const a=window.SpeechRecognition||window.webkitSpeechRecognition;if(!a)throw new Error("Speech recognition not supported");this.recognition=new a,this.recognition.continuous=!0,this.recognition.interimResults=!1,this.recognition.lang="en-US",this.recognition.onresult=h=>{const d=h.results.length-1,p=h.results[d][0].transcript.trim().toLowerCase();console.log("Voice detected:",p);const m=this.validCommands.find(S=>p.includes(S));m&&this.emit("command",m)},this.recognition.onerror=h=>{console.error("Speech recognition error:",h.error),h.error==="no-speech"&&this.isListening&&this.recognition.start()},this.recognition.onend=()=>{if(this.isListening)try{this.recognition.start()}catch{}}}async start(){if(!this.isListening)try{this.recognition.start(),this.isListening=!0,console.log("Voice recognition started")}catch(a){console.error("Failed to start speech recognition:",a)}}stop(){this.isListening&&(this.isListening=!1,this.recognition.stop())}on(a,h){this.listeners.has(a)||this.listeners.set(a,[]),this.listeners.get(a).push(h)}emit(a,h){const d=this.listeners.get(a);d&&d.forEach(p=>p(h))}destroy(){this.stop(),this.listeners.clear()}}class zn{constructor(a){this.renderer=a,this.device=a.device,this.particles=[]}reset(){this.particles.forEach(a=>{a.vertexBuffer&&a.vertexBuffer.destroy()}),this.particles=[]}createExplosion(a,h){for(let p=0;p<30;p++){const m=p/30*Math.PI*2,S=2+Math.random()*3,y=[Math.cos(m)*S,(Math.random()-.5)*S,Math.sin(m)*S],E={position:[...a],velocity:y,color:h||[1,.5,0],life:1,size:.1+Math.random()*.1};this.createParticleGeometry(E),this.particles.push(E)}}createParticleGeometry(a){const h=a.size,d=[-h,-h,0,...a.color,1,h,-h,0,...a.color,1,h,h,0,...a.color,1,-h,-h,0,...a.color,1,h,h,0,...a.color,1,-h,h,0,...a.color,1],p=new Float32Array(d);a.vertexBuffer=this.device.createBuffer({size:p.byteLength,usage:GPUBufferUsage.VERTEX|GPUBufferUsage.COPY_DST}),this.device.queue.writeBuffer(a.vertexBuffer,0,p)}update(a){for(let h=this.particles.length-1;h>=0;h--){const d=this.particles[h];d.position[0]+=d.velocity[0]*a,d.position[1]+=d.velocity[1]*a,d.position[2]+=d.velocity[2]*a,d.velocity[1]-=2*a,d.life-=a*.8,d.life<=0&&(d.vertexBuffer&&d.vertexBuffer.destroy(),this.particles.splice(h,1))}}getParticles(){return this.particles}}class Vn{constructor(){this.canvas=document.getElementById("gpuCanvas"),this.renderer=null,this.gameState=null,this.shapeSpawner=null,this.handTracker=null,this.voiceRecognition=null,this.particleSystem=null,this.isInitialized=!1,this.lastTime=performance.now(),this.crosshair=document.getElementById("crosshair"),this.handIndicator=document.getElementById("handIndicator"),this.targetedShape=null,this.currentGameState="initializing",this.startButton=document.getElementById("startBtn"),this.isHoveringStartButton=!1}async init(){try{this.showStatus("Initializing hand tracking..."),this.handTracker=new kn,await this.handTracker.init(),await this.handTracker.start(),this.startMenuTracking(),this.showStatus("Initializing voice recognition..."),this.voiceRecognition=new Hn,await this.voiceRecognition.init(),await this.voiceRecognition.start(),this.showStatus("Initializing WebGPU..."),this.renderer=new Ln(this.canvas),await this.renderer.init(),this.gameState=new Rn,this.shapeSpawner=new _n(this.renderer),this.particleSystem=new zn(this.renderer),this.setupEventListeners(),this.isInitialized=!0,this.currentGameState="ready",document.getElementById("status").classList.add("hidden"),this.showStatus('Ready! Aim at START and say "BANG"')}catch(a){console.error("Initialization error:",a),this.showStatus(`Error: ${a.message}`)}}startMenuTracking(){const a=()=>{if(this.currentGameState==="ready"){const h=this.handTracker.getPointerPosition(),d=this.handTracker.isHandDetected(),p=document.getElementById("handStatus");if(d?(p.textContent="HAND DETECTED",p.classList.add("detected"),p.classList.remove("not-detected")):(p.textContent="NO HAND DETECTED",p.classList.remove("detected"),p.classList.add("not-detected")),h){if(this.crosshair.style.left=`${h.x}px`,this.crosshair.style.top=`${h.y}px`,this.handIndicator.style.left=`${h.x}px`,this.handIndicator.style.top=`${h.y}px`,this.handIndicator.style.opacity="0.8",this.startButton){const m=this.startButton.getBoundingClientRect(),S=h.x>=m.left&&h.x<=m.right&&h.y>=m.top&&h.y<=m.bottom;this.isHoveringStartButton=S,S?(this.crosshair.classList.add("targeting"),this.startButton.classList.add("targeted")):(this.crosshair.classList.remove("targeting"),this.startButton.classList.remove("targeted"))}}else this.handIndicator.style.opacity="0";requestAnimationFrame(a)}};a()}setupEventListeners(){const a=document.getElementById("startBtn"),h=document.getElementById("restartBtn");a.addEventListener("click",()=>this.startGame()),h.addEventListener("click",()=>this.restartGame()),this.voiceRecognition.on("command",d=>this.handleVoiceCommand(d))}handleVoiceCommand(a){const h=document.getElementById("voiceFeedback");if(h.textContent=`"${a}"`,h.classList.add("show"),setTimeout(()=>{h.classList.remove("show")},1e3),this.currentGameState==="ready"&&(a.toLowerCase().includes("bang")||a.toLowerCase().includes("fire")||a.toLowerCase().includes("shoot"))){this.isHoveringStartButton?(h.classList.add("correct"),h.classList.remove("incorrect"),h.textContent='"BANG!" - STARTING GAME',setTimeout(()=>{this.startGame()},500)):(h.classList.add("incorrect"),h.classList.remove("correct"),h.textContent="AIM AT START BUTTON!");return}if(this.currentGameState==="playing"){if(!this.targetedShape){h.classList.add("incorrect"),h.classList.remove("correct");return}a.toLowerCase()===this.targetedShape.type.toLowerCase()?(h.classList.add("correct"),h.classList.remove("incorrect"),this.destroyShape(this.targetedShape),this.gameState.addScore(100)):(h.classList.add("incorrect"),h.classList.remove("correct"))}}async startGame(){document.getElementById("startScreen").classList.add("hidden"),document.getElementById("status").classList.add("hidden"),this.currentGameState="playing",this.gameState.reset(),this.shapeSpawner.reset(),this.particleSystem.reset(),this.gameLoop()}restartGame(){document.getElementById("gameOver").classList.remove("show"),this.currentGameState="ready",this.startMenuTracking(),document.getElementById("startScreen").classList.remove("hidden")}gameLoop(){if(!this.isInitialized||this.gameState.isGameOver)return;const a=performance.now(),h=(a-this.lastTime)/1e3;this.lastTime=a;const d=this.handTracker.getPointerPosition(),p=this.handTracker.isHandDetected(),m=document.getElementById("handStatus");p?(m.textContent="HAND DETECTED",m.classList.add("detected"),m.classList.remove("not-detected")):(m.textContent="NO HAND DETECTED",m.classList.remove("detected"),m.classList.add("not-detected")),d?(this.crosshair.style.left=`${d.x}px`,this.crosshair.style.top=`${d.y}px`,this.handIndicator.style.left=`${d.x}px`,this.handIndicator.style.top=`${d.y}px`,this.handIndicator.style.opacity="0.6"):this.handIndicator.style.opacity="0",this.shapeSpawner.update(h,this.gameState.wave),this.shapeSpawner.getShapes().forEach(y=>{y.position[2]+=y.velocity*h,y.position[2]>2&&this.gameOver()}),this.targetedShape=this.performRaycast(d),this.targetedShape?this.crosshair.classList.add("targeting"):this.crosshair.classList.remove("targeting"),this.particleSystem.update(h),this.renderer.render({shapes:this.shapeSpawner.getShapes(),particles:this.particleSystem.getParticles(),targetedShape:this.targetedShape,deltaTime:h}),this.updateHUD(),requestAnimationFrame(()=>this.gameLoop())}performRaycast(a){if(!a)return null;const d=this.shapeSpawner.getShapes().map(S=>{const y=this.renderer.projectToScreen(S.position);return{shape:S,projected:y}});let p=null,m=60;return d.forEach(({shape:S,projected:y})=>{if(y){const E=y.x-a.x,U=y.y-a.y,P=Math.sqrt(E*E+U*U);P<m&&(m=P,p=S)}}),p}destroyShape(a){this.particleSystem.createExplosion(a.position,a.color),this.shapeSpawner.removeShape(a)}updateHUD(){document.getElementById("score").textContent=this.gameState.score,document.getElementById("wave").textContent=this.gameState.wave,document.getElementById("shapeCount").textContent=this.shapeSpawner.getShapes().length}gameOver(){this.gameState.isGameOver=!0,this.currentGameState="gameOver",document.getElementById("finalScore").textContent=this.gameState.score,document.getElementById("gameOver").classList.add("show")}showStatus(a){const h=document.getElementById("status");h&&(h.textContent=a)}}const Wn=new Vn;Wn.init();
//# sourceMappingURL=index-ID39-9hF.js.map
